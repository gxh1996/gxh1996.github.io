window.__require=function e(t,o,n){function i(a,s){if(!o[a]){if(!t[a]){var l=a.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+a+"'")}}var p=o[a]={exports:{}};t[a][0].call(p.exports,function(e){return i(t[a][1][e]||e)},p,p.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({IDataStorage:[function(e,t,o){"use strict";cc._RF.push(t,"5c565cphqFBXKa9CVjv02eW","IDataStorage"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],UIEvent:[function(e,t,o){"use strict";cc._RF.push(t,"96d26U7JXVH+oTEagOLhy0W","UIEvent"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=e("../modules/debugUtil"),r=e("../modules/global"),a=e("../modules/dataManager"),s=e("../common/mathUtil"),l=e("../modules/soundManager"),c=cc._decorator,p=c.ccclass,u=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.panel=null,t.title=null,t.review=null,t.direction=null,t.indexButton=null,t.resetButton=null,t.nextButton=null,t.bgmButton=null,t.pauseButton=null,t.butLayout=null,t.butPoints=[cc.v2(-130,-90),cc.v2(0,-90),cc.v2(130,-90)],t}return __extends(t,e),t.prototype.onLoad=function(){this.eventMgr=n.default.ins,this.eventMgr.onEvent(n.EventType.ShowFailPanel,this.showFailPanel,this),this.eventMgr.onEvent(n.EventType.ShowWinPanel,this.showWinPanel,this)},t.prototype.pauseGame=function(){cc.director.pause(),this.eventMgr.sendEvent(n.EventType.OpenPanel,this.panel),this.title.node.active=!0,this.title.string="\u6e38\u620f\u6682\u505c",this.title.node.color=cc.Color.BLUE,this.review.active=!1,this.direction.active=!1,this.indexButton.active=!0,this.resetButton.active=!0,this.nextButton.active=!1,this.butLayout.updateLayout()},t.prototype.continueGame=function(){cc.director.resume(),this.eventMgr.sendEvent(n.EventType.ClosePanel,this.panel)},t.prototype.resetBut=function(){cc.director.resume(),i.default.ins.log(i.DebugKey.GameLogic,"\u91cd\u65b0\u52a0\u8f7d\u573a\u666f"),this.eventMgr.sendEvent(n.EventType.ResetGame),this.eventMgr.sendEvent(n.EventType.ClosePanel,this.panel),this.pauseButton.getComponent("switchBut").setState(1),this.resetButZIndex()},t.prototype.indexBut=function(){cc.director.resume(),this.eventMgr.sendEvent(n.EventType.LoadIndexScene)},t.prototype.nextBut=function(){r.default.ins.curLevelNum+1<=a.default.ins.levelSum&&(cc.director.resume(),this.eventMgr.sendEvent(n.EventType.ClosePanel,this.panel),this.eventMgr.sendEvent(n.EventType.NextLevel),this.resetButZIndex())},t.prototype.resetButZIndex=function(){this.pauseButton.zIndex=1,this.bgmButton.zIndex=1},t.prototype.showFailPanel=function(){this.pauseButton.zIndex=-1,this.bgmButton.zIndex=-1,this.eventMgr.sendEvent(n.EventType.OpenPanel,this.panel),this.title.node.active=!0,this.title.string="\u518d\u63a5\u518d\u52b1",this.title.node.color=cc.Color.RED,this.review.active=!1,this.direction.active=!1,this.indexButton.active=!0,this.resetButton.active=!0,this.nextButton.active=!1,this.butLayout.updateLayout()},t.prototype.showWinPanel=function(e){this.pauseButton.zIndex=-1,this.bgmButton.zIndex=-1,this.eventMgr.sendEvent(n.EventType.OpenPanel,this.panel),this.title.node.active=!0,this.title.string="\u6e38\u620f\u6210\u529f",this.title.node.color=cc.Color.YELLOW,this.review.active=!0,this.direction.active=!0,this.indexButton.active=!0,this.resetButton.active=!0,r.default.ins.curLevelNum<a.default.ins.levelSum&&(this.nextButton.active=!0),this.butLayout.updateLayout(),a.default.ins.refreshGetStar(r.default.ins.curLevelNum,s.default.sumOfArray(e)),this.setEvaluate(e)},t.prototype.setEvaluate=function(e){for(var t=0;t<e.length;t++)this.setStar(this.review.children[t],e[t]),this.setDirection(this.direction.children[t],e[t])},t.prototype.setStar=function(e,t){e.opacity=1===t?255:50},t.prototype.setDirection=function(e,t){e.color=1===t?cc.Color.GREEN:cc.Color.RED},t.prototype.openSound=function(){l.default.ins.openSound()},t.prototype.closeSound=function(){l.default.ins.closeSound()},t.prototype.onDestroy=function(){n.default.ins.deleteSubscriber(this)},__decorate([u(cc.Node)],t.prototype,"panel",void 0),__decorate([u(cc.Label)],t.prototype,"title",void 0),__decorate([u(cc.Node)],t.prototype,"review",void 0),__decorate([u(cc.Node)],t.prototype,"direction",void 0),__decorate([u(cc.Node)],t.prototype,"indexButton",void 0),__decorate([u(cc.Node)],t.prototype,"resetButton",void 0),__decorate([u(cc.Node)],t.prototype,"nextButton",void 0),__decorate([u(cc.Node)],t.prototype,"bgmButton",void 0),__decorate([u(cc.Node)],t.prototype,"pauseButton",void 0),__decorate([u(cc.Layout)],t.prototype,"butLayout",void 0),t=__decorate([p],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../common/mathUtil":"mathUtil","../modules/dataManager":"dataManager","../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager","../modules/global":"global","../modules/soundManager":"soundManager"}],UIHelper:[function(e,t,o){"use strict";cc._RF.push(t,"8b0eavEFhRFRpoCv3ImgGX8","UIHelper"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./eventManager/eventManager"),i=function(){function e(){this.eventMgr=n.default.ins,this.eventMgr.onEvent(n.EventType.OpenPanel,this.openPanel,this),this.eventMgr.onEvent(n.EventType.ClosePanel,this.closePanel,this)}return e.init=function(){this.ins||(this.ins=new e)},e.prototype.openPanel=function(e){e.active=!0},e.prototype.closePanel=function(e){e.active=!1},e}();o.default=i,cc._RF.pop()},{"./eventManager/eventManager":"eventManager"}],adaptScreen:[function(e,t,o){"use strict";cc._RF.push(t,"602dafofrBD/oay0UsXrElR","adaptScreen"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=n.disallowMultiple,s=n.menu,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.proportionallyShowNode=[],t.fullScreenNodeBySize=[],t.fullScreenNodeByScale=[],t.canvas=null,t.originDesSize=null,t.adaptedDesSize=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.canvas=this.node.getComponent(cc.Canvas);var e=cc.view.getCanvasSize(),t=cc.view.getDesignResolutionSize();this.originDesSize=t.clone(),this.adaptedDesSize=t.clone();var o=e.width/e.height;this.adaptedDesSize.width=this.adaptedDesSize.height*o,this.canvas.designResolution=this.adaptedDesSize,this.adaptNode(),console.log("\u9002\u914d\u540e\u8bbe\u8ba1\u5206\u8fa8\u7387\uff1a",this.canvas.designResolution)},t.prototype.adaptNode=function(){var e,t,o=this.adaptedDesSize.width/this.originDesSize.width,n=this.adaptedDesSize.height/this.originDesSize.height;e=o>n?n:o;for(var i=0,r=this.proportionallyShowNode;i<r.length;i++)(t=r[i]).scale=e;for(var a=0,s=this.fullScreenNodeBySize;a<s.length;a++)(t=s[a]).height=this.adaptedDesSize.height,t.width=this.adaptedDesSize.width;for(var l=0,c=this.fullScreenNodeByScale;l<c.length;l++)(t=c[l]).scaleX=o,t.scaleY=n},__decorate([r({type:cc.Node,tooltip:"\u81ea\u52a8\u7f29\u653e\u4f7fUI\u9762\u677f\u5185\u5bb9\u5168\u90e8\u663e\u793a\u5728\u5c4f\u5e55\u4e2d"})],t.prototype,"proportionallyShowNode",void 0),__decorate([r({type:cc.Node,tooltip:"\u8bbe\u7f6e\u8282\u70b9\u5927\u5c0f\u4e3a\u9002\u914d\u540e\u7684\u8bbe\u8ba1\u5206\u8fa8\u7387\u5927\u5c0f\uff0c\u4f8b\u5982mask\u3001\u80cc\u666f\u7b49"})],t.prototype,"fullScreenNodeBySize",void 0),__decorate([r({type:cc.Node,tooltip:"\u8bbe\u7f6e\u8282\u70b9\u7f29\u653e\u4e3a\u9002\u914d\u540e\u7684\u8bbe\u8ba1\u5206\u8fa8\u7387\u5927\u5c0f"})],t.prototype,"fullScreenNodeByScale",void 0),t=__decorate([i,a,s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/AdaptScreen")],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],adaptWXMenu:[function(e,t,o){"use strict";cc._RF.push(t,"68188iGDeBEzahdzW8C3HBH","adaptWXMenu"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.disallowMultiple,a=n.menu,s=n.requireComponent,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){if("undefined"!=typeof wx){this.cancelAdaptTop();var e=cc.view.getVisibleSize(),t=wx.getMenuButtonBoundingClientRect(),o=e.height-t.bottom;this.node.y=this.node.parent.convertToNodeSpace(cc.v2(0,o)).y}},t.prototype.cancelAdaptTop=function(){var e=this.node.getComponent(cc.Widget);e.isAlignTop=!1,e.updateAlignment()},t=__decorate([i,r,s(cc.Widget),a("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/AdaptWXMenu")],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],arrow:[function(e,t,o){"use strict";cc._RF.push(t,"27f74i4J3hO3qV32OaNkP2+","arrow"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/frameAnim"),i=e("../modules/eventManager/eventManager"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hitAtlas=null,t.anim=null,t.upForce=80,t.rigid=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.onBeginContact=function(e,t,o){"PLAYER"===o.node.group&&(i.default.ins.sendEvent(i.EventType.ChangeSpeedYPlayer,0),i.default.ins.sendEvent(i.EventType.ApplyImpulsionToPlayer,cc.v2(0,this.upForce)),this.active(),this.rigid.enabledContactListener=!1)},t.prototype.active=function(){var e=this;this.anim.stop(),this.anim.setSpriteAtlas(this.hitAtlas),this.anim.play(!1,function(){e.node.destroy()}.bind(this))},__decorate([s(cc.SpriteAtlas)],t.prototype,"hitAtlas",void 0),__decorate([s(n.default)],t.prototype,"anim",void 0),__decorate([s()],t.prototype,"upForce",void 0),__decorate([s(cc.RigidBody)],t.prototype,"rigid",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../common/frameAnim":"frameAnim","../modules/eventManager/eventManager":"eventManager"}],background:[function(e,t,o){"use strict";cc._RF.push(t,"f9917Ff96hKqqNaDy9ynCVU","background"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property;(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=10,t.isActive=!1,t}__extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){this.active()},t.prototype.active=function(){this.map=this.node.getComponent(cc.TiledMap),this.mapSize=this.getMapSize(),this.bg1=this.map.getLayer("bg1"),this.bg2=this.map.getLayer("bg2"),this.bg1&&this.bg2?(this.bg2Size=this.getBg2Size(),this.bg2.node.y=this.bg2Size.height,this.isActive=!0):console.warn("\u6ca1\u6709\u80cc\u666f\u8282\u70b9")},t.prototype.getBg2Size=function(){var e=this.map.getTileSize();return new cc.Size(this.mapSize.width,4*e.height)},t.prototype.getMapSize=function(){var e=this.map.getMapSize(),t=this.map.getTileSize();return new cc.Size(e.width*t.width,e.height*t.height)},t.prototype.update=function(e){if(this.isActive){var t=e*this.speed;this.bg1.node.y-=t,this.bg2.node.y-=t,this.bg2.node.y<=0&&(this.bg2.node.y=this.bg2Size.height,this.bg1.node.y=0)}},t.prototype.onDestroy=function(){},__decorate([r({displayName:"\u79fb\u52a8\u901f\u5ea6"})],t.prototype,"speed",void 0),t=__decorate([i],t)})(cc.Component);cc._RF.pop()},{}],blockBg:[function(e,t,o){"use strict";cc._RF.push(t,"15e36bnUAZKapbrw7pg1rZy","blockBg"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/mathUtil"),i=e("../../modules/debugUtil"),r=e("../../common/frameAnim"),a=cc._decorator,s=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hitTop=null,t.anim=null,t.hited=!1,t}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){if(!this.hited&&(i.default.ins.log(i.DebugKey.Block,"block\u53d1\u9001\u78b0\u649e!"),"PLAYER"===o.node.group)){var r=n.default.relativeLocationVertical(t,o);if(r){var a=o.node.getComponent(cc.RigidBody);(-1===r&&a.linearVelocity.y<-2||1===r&&a.linearVelocity.y>2)&&(this.node.dispatchEvent(new cc.Event.EventCustom("hited",!0)),this.hited=!0)}}},t.prototype.hit=function(e){i.default.ins.log(i.DebugKey.Block,"\u64ad\u653eblock\u88ab\u7834\u574f\u52a8\u753b"),this.anim.setSpriteAtlas(this.hitTop),this.anim.play(!1,e)},__decorate([l(cc.SpriteAtlas)],t.prototype,"hitTop",void 0),__decorate([l(r.default)],t.prototype,"anim",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../common/frameAnim":"frameAnim","../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil"}],block:[function(e,t,o){"use strict";cc._RF.push(t,"00e12/JgO5MBaagb2cY9Fcu","block"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./blockBg"),i=e("../chip"),r=e("../../common/mathUtil"),a=e("../../modules/debugUtil"),s=cc._decorator,l=s.ccclass,c=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockBg=null,t.down=null,t.up=null,t.randomSpeed={min:-40,max:40},t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on("hited",this.hitedEvent,this)},t.prototype.hitedEvent=function(e){var t=this;a.default.ins.log(a.DebugKey.Block,"block\u88ab\u653b\u51fb"),e.stopPropagation(),this.blockBg.hit(function(){t.blockBg.node.active=!1,t.showChip()}.bind(this)),this.scheduleOnce(this.node.destroy,5)},t.prototype.showChip=function(){this.up.node.active=!0,this.down.node.active=!0,this.setRandomSpeed(this.up.rigid),this.setRandomSpeed(this.down.rigid)},t.prototype.setRandomSpeed=function(e){var t=r.default.getRandomInteger(this.randomSpeed.min,this.randomSpeed.max),o=r.default.getRandomInteger(this.randomSpeed.min,this.randomSpeed.max);e.linearVelocity=cc.v2(t,o)},__decorate([c(n.default)],t.prototype,"blockBg",void 0),__decorate([c(i.default)],t.prototype,"down",void 0),__decorate([c(i.default)],t.prototype,"up",void 0),t=__decorate([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil","../chip":"chip","./blockBg":"blockBg"}],blowWind:[function(e,t,o){"use strict";cc._RF.push(t,"f1c6dyNy4VEToEFkYQmIxeR","blowWind"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/frameAnim"),i=e("../common/commonVar"),r=e("../modules/debugUtil"),a=e("../modules/eventManager/eventManager"),s=cc._decorator,l=s.ccclass,c=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAtlas=null,t.offImg=null,t.anim=null,t.windSpeed=40,t.intervalOfT=5,t.duration=5,t.dir=i.Dir.up,t.particle=null,t.rigid=null,t.cT=0,t.isOn=!1,t.isCollided=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.rigid=this.node.getComponent(cc.RigidBody),this.anim.setIdleImg(this.offImg),this.anim.setSpriteAtlas(this.onAtlas),this.rigid.enabledContactListener=!0},t.prototype.onBeginContact=function(e,t,o){"PLAYER"===o.node.group&&(r.default.ins.log(r.DebugKey.BlowWind,"\u78b0\u649e\u5230\u73a9\u5bb6"),this.isCollided=!0,this.isOn&&this.blowPlayer())},t.prototype.onEndContact=function(e,t,o){"PLAYER"===o.node.group&&(r.default.ins.log(r.DebugKey.BlowWind,"\u7ed3\u675f\u548c\u73a9\u5bb6\u7684\u78b0\u649e"),this.isCollided=!1,this.isOn&&this.endBlowPlayer())},t.prototype.blowPlayer=function(){var e=this.getWindSpeed();r.default.ins.log(r.DebugKey.BlowWind,"\u5439\u8d77\u89d2\u8272\uff0c\u98ce\u901f\u4e3a"+e),a.default.ins.sendEvent(a.EventType.GivePlayerConstantSpeed,new i.GiveExtraSpeed("blowWind",e))},t.prototype.endBlowPlayer=function(){this.getWindSpeed();r.default.ins.log(r.DebugKey.BlowWind,"\u7ed3\u675f\u5439\u8d77\u89d2\u8272"),a.default.ins.sendEvent(a.EventType.RemovePlayerConstantSpeed,"blowWind")},t.prototype.initParticleAngle=function(){var e;switch(this.dir){case i.Dir.up:e=90;break;case i.Dir.down:e=270;break;case i.Dir.left:e=180;break;case i.Dir.right:e=0}this.particle.angle=e},t.prototype.getWindSpeed=function(){var e;switch(this.dir){case i.Dir.up:e=cc.v2(0,this.windSpeed);break;case i.Dir.down:e=cc.v2(0,-this.windSpeed);break;case i.Dir.left:e=cc.v2(-this.windSpeed,0);break;case i.Dir.right:e=cc.v2(this.windSpeed,0)}return e},t.prototype.on=function(){r.default.ins.log(r.DebugKey.BlowWind,"\u6253\u5f00\u5439\u98ce\u88c5\u7f6e"),this.anim.play(!0),this.particle.resetSystem(),this.isOn=!0,this.isCollided&&this.blowPlayer()},t.prototype.off=function(){r.default.ins.log(r.DebugKey.BlowWind,"\u5173\u95ed\u5439\u98ce\u88c5\u7f6e"),this.anim.stop(),this.particle.stopSystem(),this.isOn=!1,this.isCollided&&this.endBlowPlayer()},t.prototype.autoRun=function(){this.isOn?this.cT>=this.duration&&(this.off(),this.cT=0):this.cT>=this.intervalOfT&&(this.on(),this.cT=0)},t.prototype.update=function(e){this.cT+=e,this.autoRun()},__decorate([c(cc.SpriteAtlas)],t.prototype,"onAtlas",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"offImg",void 0),__decorate([c(n.default)],t.prototype,"anim",void 0),__decorate([c({displayName:"\u98ce\u901f"})],t.prototype,"windSpeed",void 0),__decorate([c({displayName:"\u9694\u591a\u4e45\u5f00\u542f\u4e00\u6b21"})],t.prototype,"intervalOfT",void 0),__decorate([c({displayName:"\u4e00\u6b21\u5439\u591a\u4e45"})],t.prototype,"duration",void 0),__decorate([c({type:i.Dir,displayName:"\u98ce\u7684\u65b9\u5411"})],t.prototype,"dir",void 0),__decorate([c(cc.ParticleSystem)],t.prototype,"particle",void 0),t=__decorate([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../common/commonVar":"commonVar","../common/frameAnim":"frameAnim","../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager"}],boxBg:[function(e,t,o){"use strict";cc._RF.push(t,"fed13k7hDRNrJcBJ1xn2uRU","boxBg"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/mathUtil"),i=e("../../modules/debugUtil"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.idleImg=null,t.hitAtlas=null,t.anim=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.node.getComponent("frameAnim"),this.anim.setIdleImg(this.idleImg),this.anim.setSpriteAtlas(this.hitAtlas)},t.prototype.onBeginContact=function(e,t,o){if("PLAYER"===o.node.group){var r=n.default.relativeLocationVertical(o,t),a=o.node.getComponent(cc.RigidBody);(-1===r&&a.linearVelocity.y>2||1===r&&a.linearVelocity.y<-2)&&(i.default.ins.log(i.DebugKey.Box,"\u7bb1\u5b50\u88ab\u653b\u51fb"),this.node.dispatchEvent(new cc.Event.EventCustom("hited",!0)))}},t.prototype.hit=function(e){i.default.ins.log(i.DebugKey.Box,"\u64ad\u653e\u7bb1\u5b50\u88ab\u653b\u51fb\u52a8\u753b"),this.anim.play(!1,e)},__decorate([s(cc.SpriteFrame)],t.prototype,"idleImg",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"hitAtlas",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil"}],box:[function(e,t,o){"use strict";cc._RF.push(t,"a20e3hogT5F3IjTKLglsn40","box"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./boxBg"),i=e("../../common/mathUtil"),r=e("../chip"),a=e("../../modules/eventManager/eventManager"),s=e("../../modules/debugUtil"),l=cc._decorator,c=l.ccclass,p=l.property,u=cc.Enum({Box1:0,Box2:1,Box3:2}),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boxBg=null,t.leftUp=null,t.rightUp=null,t.leftDown=null,t.rightDown=null,t.type=u.Box1,t.hitCount=1,t.randomSpeed={min:5,max:40},t.fruitMgr=null,t}return __extends(t,e),t.prototype.onLoad=function(){a.default.ins.onEvent(a.EventType.FruitMgrNotice,this.fruitMgrNotice,this),this.node.on("hited",this.hitEvent,this)},t.prototype.start=function(){},t.prototype.fruitMgrNotice=function(e){this.fruitMgr=e},t.prototype.hitEvent=function(e){e.stopPropagation(),this.hitCount--,this.boxBg.hit(null),0===this.hitCount?this.break():this.outFruit()},t.prototype.break=function(){s.default.ins.log(s.DebugKey.Box,"\u9690\u85cf\u7bb1\u5b50, \u663e\u793a\u788e\u7247"),this.boxBg.node.active=!1,this.activeChip(),this.outFruits(),this.scheduleOnce(this.node.destroy,5)},t.prototype.activeChip=function(){this.leftUp.node.active=!0,this.rightUp.node.active=!0,this.leftDown.node.active=!0,this.rightDown.node.active=!0,this.leftUp.rigid.linearVelocity=cc.v2(-this.getRandomSpeed(),this.getRandomSpeed()),this.rightUp.rigid.linearVelocity=cc.v2(this.getRandomSpeed(),this.getRandomSpeed()),this.leftDown.rigid.linearVelocity=cc.v2(-this.getRandomSpeed(),this.getRandomSpeed()),this.rightDown.rigid.linearVelocity=cc.v2(this.getRandomSpeed(),this.getRandomSpeed())},t.prototype.outFruits=function(){var e=0;switch(this.type){case u.Box1:case u.Box2:e=1;break;case u.Box3:e=2}for(var t=0;t<e;t++)this.outFruit()},t.prototype.outFruit=function(){var e=this.fruitMgr.createFruitRandom();if(e){e.setDynamic();var t=i.default.getNodePFromWP(e.node.parent,i.default.getWorldCoordinate(this.node)),o=i.default.getRandomSelect();t.x+=5*o,e.node.setPosition(t),e.rigid.linearVelocity=cc.v2(this.getRandomSpeed(20,40)*o,0),s.default.ins.log(s.DebugKey.Box,"\u6c34\u679c\u901f\u5ea6\uff1a"+e.rigid.linearVelocity)}},t.prototype.getRandomSpeed=function(e,t){return e||(e=this.randomSpeed.min),t||(t=this.randomSpeed.max),i.default.getRandomInteger(e,t)},__decorate([p(n.default)],t.prototype,"boxBg",void 0),__decorate([p(r.default)],t.prototype,"leftUp",void 0),__decorate([p(r.default)],t.prototype,"rightUp",void 0),__decorate([p(r.default)],t.prototype,"leftDown",void 0),__decorate([p(r.default)],t.prototype,"rightDown",void 0),__decorate([p({type:cc.Enum(u),displayName:"\u7bb1\u5b50\u7c7b\u578b"})],t.prototype,"type",void 0),__decorate([p({tooltip:"\u80fd\u53d7\u653b\u51fb\u7684\u6b21\u6570"})],t.prototype,"hitCount",void 0),t=__decorate([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil","../../modules/eventManager/eventManager":"eventManager","../chip":"chip","./boxBg":"boxBg"}],butController:[function(e,t,o){"use strict";cc._RF.push(t,"dc0adYdMHZKwI++IwK+5S42","butController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.downJumpBut=function(){n.default.ins.sendEvent(n.EventType.JumpButDown)},t.prototype.downLeftBut=function(){n.default.ins.sendEvent(n.EventType.MoveButDown,-1)},t.prototype.upLeftBut=function(){n.default.ins.sendEvent(n.EventType.MoveButUp,-1)},t.prototype.downRightBut=function(){n.default.ins.sendEvent(n.EventType.MoveButDown,1)},t.prototype.upRightBut=function(){n.default.ins.sendEvent(n.EventType.MoveButUp,1)},t=__decorate([r],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../modules/eventManager/eventManager":"eventManager"}],butControl:[function(e,t,o){"use strict";cc._RF.push(t,"0f4a7ZkkbxP8JYplHvS9Hu8","butControl"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=n.disallowMultiple,s=n.menu,l=n.requireComponent,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.downEvent=new cc.Component.EventHandler,t.upEvent=new cc.Component.EventHandler,t}return __extends(t,e),t.prototype.onLoad=function(){this.button=this.node.getComponent(cc.Button),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},t.prototype.touchStart=function(){this.downEvent.emit(null)},t.prototype.touchEnd=function(){this.upEvent.emit(null)},__decorate([r(cc.Component.EventHandler)],t.prototype,"downEvent",void 0),__decorate([r(cc.Component.EventHandler)],t.prototype,"upEvent",void 0),t=__decorate([i,a,l(cc.Button),s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/ButControl")],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],cameraFollow:[function(e,t,o){"use strict";cc._RF.push(t,"dfa15jTwHJESbDbqsn1V56E","cameraFollow"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./mathUtil"),i=e("../modules/eventManager/eventManager"),r=e("../modules/debugUtil"),a=e("../modules/global"),s=cc._decorator,l=s.ccclass,c=s.property,p=s.disallowMultiple,u=s.menu,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.target=null,t.map=null,t.range=null,t._isFollow=!1,t.isCheckOF=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"isFollow",{get:function(){return this._isFollow},set:function(e){this._isFollow=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this;i.default.ins.onEvent(i.EventType.StartCameraFollow,function(){e.isFollow=!0},this),i.default.ins.onEvent(i.EventType.StopCameraFollow,function(){e.isFollow=!1},this),i.default.ins.onEvent(i.EventType.CheckPlayerOutFace,this.checkPlayerOutFace,this),i.default.ins.onEvent(i.EventType.InitCamera,this.init,this)},t.prototype.init=function(){this.target=cc.find("Canvas/gameContent/level"+a.default.ins.curLevelNum+"/player"),this.map=cc.find("Canvas/gameContent/level"+a.default.ins.curLevelNum+"/map/tiledMap").getComponent(cc.TiledMap),this.initConfig(),this.isFollow=!0,this.isCheckOF=!1},t.prototype.initConfig=function(){var e=cc.view.getVisibleSize(),t=this.map.getMapSize(),o=this.map.getTileSize(),n=new cc.Size(t.width*o.width,t.height*o.height),i=this.getNodeP(this.map.node);this.range={minY:i.y-n.height/2+e.height/2,maxY:i.y+n.height/2-e.height/2,minX:i.x+e.width/2,maxX:i.x+n.width-e.width/2}},t.prototype.getNodeP=function(e){return this.node.parent.convertToNodeSpaceAR(n.default.getWorldCoordinate(e))},t.prototype.checkPlayerOutFace=function(){r.default.ins.log(r.DebugKey.GameLogic,"\u5f00\u59cb\u68c0\u6d4b\u89d2\u8272\u662f\u5426\u51fa\u5c4f\u5e55"),this.isCheckOF=!0},t.prototype.isOutFace=function(){var e=n.default.getWorldCoordinate(this.node),t=cc.view.getVisibleSize(),o=new cc.Rect;o.x=e.x-t.width/2,o.y=e.y-t.height/2,o.width=t.width,o.height=t.height;var i=this.target.getBoundingBoxToWorld();return i.yMax<o.yMin||i.yMin>o.yMax||i.xMax<o.xMin||i.xMin>o.xMax},t.prototype.update=function(e){if(this.isCheckOF&&this.isOutFace()&&(r.default.ins.log(r.DebugKey.GameLogic,"\u89d2\u8272\u51fa\u5c4f\u5e55"),this.isCheckOF=!1,i.default.ins.sendEvent(i.EventType.PlayerOutFace)),this.isFollow){var t=this.getNodeP(this.target);if(t.equals(this.node.getPosition()))return;t.x>this.range.maxX?t.x=this.range.maxX:t.x<this.range.minX&&(t.x=this.range.minX),t.y>this.range.maxY?t.y=this.range.maxY:t.y<this.range.minY&&(t.y=this.range.minY),this.node.setPosition(t)}},t.prototype.onDestroy=function(){i.default.ins.deleteSubscriber(this)},__decorate([c({type:cc.Node,displayName:"\u8ddf\u968f\u76ee\u6807"})],t.prototype,"target",void 0),__decorate([c(cc.TiledMap)],t.prototype,"map",void 0),t=__decorate([l,p,u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/CameraFollow")],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager","../modules/global":"global","./mathUtil":"mathUtil"}],chip:[function(e,t,o){"use strict";cc._RF.push(t,"fe7efyov/xCJaiX5Y4/1CwK","chip"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rigid=null,t}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){var n=this,i=cc.blink(2,5),r=cc.callFunc(function(){n.node.active=!1},this);this.node.runAction(cc.sequence(i,r)),this.rigid.enabledContactListener=!1},__decorate([r(cc.RigidBody)],t.prototype,"rigid",void 0),t=__decorate([i],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],climbWallState:[function(e,t,o){"use strict";cc._RF.push(t,"1112f9N2W1JAbsjw7o8CCkU","climbWallState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.beginContact=function(){this.player.isLand()&&this.player.setState(i.default.idleState)},t.prototype.endContact=function(){this.player.climbWallEnable()||this.player.setState(i.default.fallState)},t.prototype.moveBut=function(e){},t.prototype.releaseMoveBut=function(){this.player.setState(i.default.fallState)},t.prototype.jumpBut=function(){1===this.property.getJumpCount()?this.player.setState(i.default.doubleJumpState):this.player.setState(i.default.jumpState)},t.prototype.downSpeed=function(){},t.prototype.upSpeed=function(){this.player.setState(i.default.upState)},t.prototype.impulsion=function(){this.player.setState(i.default.upState)},t.prototype.enter=function(){r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u722c\u5899\u72b6\u6001"),this.player.anim.climbWall(),this.player.rigid.gravityScale=0,this.player.updateSpeed=!1,this.player.setSelfSpeed(0),this.player.setSpeedY(-this.player.property.climbWallSpeed)},t.prototype.exit=function(){this.player.anim.stop(),this.player.rigid.gravityScale=1,this.player.updateSpeed=!0,this.player.setSpeedY(0)},t=__decorate([s],t)}(n.default));o.ClimbWallState=l,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../player":"player","./playerState":"playerState"}],commonVar:[function(e,t,o){"use strict";cc._RF.push(t,"30135JZIsBFVLUrYcrdoT4P","commonVar"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property;o.WrapMode=cc.Enum({Default:cc.WrapMode.Default,Loop:cc.WrapMode.Loop,LoopReverse:cc.WrapMode.LoopReverse,Normal:cc.WrapMode.Normal,PingPong:cc.WrapMode.PingPong,PingPongReverse:cc.WrapMode.PingPongReverse,Reverse:cc.WrapMode.Reverse}),o.Dir=cc.Enum({left:0,right:1,up:2,down:3}),function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.up=2]="up",e[e.down=3]="down"}(o.DIR||(o.DIR={}));var a=function(){return function(e,t){this.force=e,this.rotate=t}}();o.HitData=a;var s=function(){return function(e,t){this.who=e,this.v=t}}();o.GiveExtraSpeed=s;var l=function(){return function(e,t,o){this.contact=e,this.self=t,this.other=o}}();o.ContactInfo=l,o.OnEndContact=function(e,t,o){void 0===o&&(o=3);var n=e.getAABB(),i=n,r=n=t.getAABB(),a=!0;return(Math.abs(i.xMax-r.xMin)<o||Math.abs(i.xMin-r.xMax)<o)&&(a=!1),a&&(Math.abs(i.yMax-r.yMin)<o||Math.abs(i.yMin-r.yMax)<o)&&(a=!1),a};var c=function(){function e(){this.startP=cc.v2(),this.endP=cc.v2()}return __decorate([r()],e.prototype,"startP",void 0),__decorate([r()],e.prototype,"endP",void 0),e=__decorate([i("Segment")],e)}();o.Segment=c;var p=function(){return function(e,t){this.num=e,this.getStar=t}}();o.levelData=p,cc._RF.pop()},{}],dataManager:[function(e,t,o){"use strict";cc._RF.push(t,"9ec0axuYOVCrqZj/fI8Vi0O","dataManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./eventManager/eventManager"),i=e("./dataStorage"),r=function(){function e(){this.eventMgr=n.default.ins,this.gameLevel=null,this.userData=null,this.eventMgr.onEventOnce(n.EventType.ResLoadComplete,this.initData,this)}return e.init=function(){this.ins=new e},e.prototype.initData=function(){var e=cc.loader.getRes("json/gameConfig",cc.JsonAsset);this.gameLevel=e.json,this.eventMgr.sendEvent(n.EventType.InitConfigComplete),this.initUserData()},e.prototype.initUserData=function(){console.log("initUserData");var e=i.default.ins.getStorageSync("userData");e?(this.userData=e,console.log("\u521d\u59cb\u5316\u7528\u6237\u6570\u636e",e),this.eventMgr.sendEvent(n.EventType.InitUserDataComplete)):(console.log("\u7528\u6237\u7b2c\u4e00\u6b21\u4f7f\u7528\uff0c\u751f\u6210\u7528\u6237\u6570\u636e"),this.userData={getStars:[]},this.eventMgr.sendEvent(n.EventType.InitUserDataComplete))},Object.defineProperty(e.prototype,"levelSum",{get:function(){return this.gameLevel.levelSum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"passLevelSum",{get:function(){return this.userData.getStars.length},enumerable:!0,configurable:!0}),e.prototype.getLeveledStarN=function(e){return e>this.passLevelSum?0:this.userData.getStars[e-1]},e.prototype.refreshGetStar=function(e,t){(!this.userData.getStars[e-1]||this.userData.getStars[e-1]<t)&&(this.userData.getStars[e-1]=t,this.uploadUserData(),console.log("\u66f4\u65b0\u7528\u6237\u6570\u636e",this.userData))},e.prototype.getedStarSum=function(){for(var e=0,t=0,o=this.userData.getStars;t<o.length;t++)e+=o[t];return e},e.prototype.getTimeOfLevel=function(e){if(!(e>this.gameLevel.levelEvaluationConditions.length))return this.gameLevel.levelEvaluationConditions[e-1].time;console.error("\u6ca1\u6709\u8fd9\u5173\u7684\u914d\u7f6e\u4fe1\u606f!")},e.prototype.getFruitSumOfLvel=function(e){if(!(e>this.gameLevel.levelEvaluationConditions.length))return this.gameLevel.levelEvaluationConditions[e-1].fruitSum;console.error("\u6ca1\u6709\u8fd9\u5173\u7684\u914d\u7f6e\u4fe1\u606f!")},e.prototype.uploadUserData=function(){i.default.ins.setStorage("userData",this.userData)},e}();o.default=r,cc._RF.pop()},{"./dataStorage":"dataStorage","./eventManager/eventManager":"eventManager"}],dataStorage:[function(e,t,o){"use strict";cc._RF.push(t,"90fa4bEk6dI0pOtqOft+a+e","dataStorage"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.ls=cc.sys.localStorage}return e.init=function(){this.ins=new e},e.prototype.setStorage=function(e,t){this.ls.setItem(e,JSON.stringify(t))},e.prototype.getStorage=function(e,t){},e.prototype.getStorageSync=function(e){return JSON.parse(this.ls.getItem(e))},e.prototype.downloadData=function(e,t){},e.prototype.uploadData=function(e,t){},e.prototype.addData=function(e,t){},e}();o.default=n,cc._RF.pop()},{}],deadState:[function(e,t,o){"use strict";cc._RF.push(t,"854aao/xJ5GmbEvpTWvBQ4t","deadState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../../modules/debugUtil"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){},t.prototype.releaseMoveBut=function(){},t.prototype.jumpBut=function(){},t.prototype.downSpeed=function(){},t.prototype.upSpeed=function(){},t.prototype.beginContact=function(){},t.prototype.endContact=function(){},t.prototype.impulsion=function(){},t.prototype.enter=function(){i.default.ins.log(i.DebugKey.PlayerState,"\u8fdb\u5165\u5230\u6b7b\u4ea1\u72b6\u6001")},t.prototype.exit=function(){},t=__decorate([a],t)}(n.default));o.DeadState=s,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","./playerState":"playerState"}],debugUtil:[function(e,t,o){"use strict";cc._RF.push(t,"b755281qmRPWK+QnXEb9N3q","debugUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc.Enum({GameLogic:"GameLogic",FruitManager:"FruitManager",Box:"Box",Block:"Block",PlayerState:"PlayerState",BlowWind:"BlowWind",ClickButton:"ClickButton",Fire:"Fire",MovedPlatformBg:"MovedPlatformBg",Property:"Property",RockHead:"RockHead",LoadPage:"LoadPage"});o.DebugKey=n;var i=function(){function e(){this.keys=new Map}return e.init=function(){this.ins=new e},e.prototype.log=function(e,t,o){this.keys[e]&&console.log("#DEBUG-"+e+":"+t,o||"")},e.prototype.openDebug=function(e){this.keys[e]=!0},e}();o.default=i,cc._RF.pop()},{}],debug:[function(e,t,o){"use strict";cc._RF.push(t,"9ab634UrYhFTrF0M+K39Ulg","debug"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){},t.prototype.showScene=function(){console.log(cc.director.getScene())},t.prototype.loadLevel=function(){cc.director.loadScene("level1")},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],doubleJumpState:[function(e,t,o){"use strict";cc._RF.push(t,"f6246ENZxVK+6KcjDsTnJJa","doubleJumpState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=e("../../modules/soundManager"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.releaseMoveBut=function(){this.player.setSelfSpeed(0)},t.prototype.jumpBut=function(){},t.prototype.beginContact=function(){this.player.isLand()&&(0===this.property.isClickMoveBut?this.player.setState(i.default.idleState):this.player.setState(i.default.runState))},t.prototype.endContact=function(){},t.prototype.downSpeed=function(){this.player.anim.isPlay()||this.player.setState(i.default.fallState)},t.prototype.upSpeed=function(){this.player.anim.isPlay()||this.player.setState(i.default.upState)},t.prototype.impulsion=function(){},t.prototype.enter=function(){r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u5230\u4e8c\u6bb5\u8df3\u8dc3\u72b6\u6001"),a.default.ins.playEffect("sounds/jump"),this.property.addJumpCount(),this.player.anim.doubleJump(),this.player.setSpeedY(0),this.player.applyImpulsion(cc.v2(0,this.property.jumpForce));var e=this.property.isClickMoveBut;0!==e&&this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.exit=function(){this.player.anim.stop()},t=__decorate([l],t)}(n.default));o.DoubleJumpState=c,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../../modules/soundManager":"soundManager","../player":"player","./playerState":"playerState"}],endPoint:[function(e,t,o){"use strict";cc._RF.push(t,"02f62PUPGVBxr/zb/hwX2PF","endPoint"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/mathUtil"),i=e("../common/commonVar"),r=e("../modules/eventManager/eventManager"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isEnd=!1,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.onBeginContact=function(e,t,o){this.isEnd||"PLAYER"===o.node.group&&n.default.isSide(o,t,i.DIR.up)&&(this.isEnd=!0,r.default.ins.sendEvent(r.EventType.Win))},t=__decorate([s],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../common/commonVar":"commonVar","../common/mathUtil":"mathUtil","../modules/eventManager/eventManager":"eventManager"}],eventCenter:[function(e,t,o){"use strict";cc._RF.push(t,"ecf78kSMLJPdY52dkmVeYJG","eventCenter"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){this.setSubscriber(e),this.setDealFunc(t)}return e.prototype.getSubscriber=function(){return this.subscriber},e.prototype.setSubscriber=function(e){this.subscriber=e},e.prototype.getDealFunc=function(){return this.dealFunc},e.prototype.setDealFunc=function(e){this.dealFunc=e},e.prototype.dealEvent=function(e){this.dealFunc.call(this.subscriber,e)},e}(),i=function(){function e(){this.eventSubscribeList=null,this.eventsOfSubscriber=null,this.eventSubscribeList=[],this.eventsOfSubscriber=new Map}return e.prototype.publishEvent=function(e,t){void 0===t&&(t=null);var o=this.findEventSubscribes(e);if(null===o)return console.error("\u8fd8\u6ca1\u6709\u4eba\u76d1\u542c\u8be5\u4e8b\u4ef6"+e+",\u8bf7\u5904\u7406\uff01"),!1;for(var n=o.slice(0,o.length),i=0;i<n.length;i++)n[i].dealEvent(t);return!0},e.prototype.addSubscribe=function(e,t,o){var i=new n(e,o),r=this.findEventSubscribes(t);if(null===r)(r=[]).push(i),this.eventSubscribeList.push([t,r]);else{if(this.isSubscribed(e,t))return cc.error("\u5df2\u8ba2\u9605\u8fc7\u4e8b\u4ef6"+t),!1;r.push(i)}return this.addSubscribEvents(e,t),!0},e.prototype.cancelSubscribe=function(e,t){var o=this.findEventSubscribes(t);if(null!==o)for(var n=0;n<o.length;n++)if(o[n].getSubscriber()===e)return o.splice(n,1),this.deleteSubscribEvents(e,t),!0;return console.error("\u53d6\u6d88\u8ba2\u9605\u5931\u8d25\uff01\u6ca1\u6709\u8ba2\u9605\u8be5\u4e8b\u4ef6"),!1},e.prototype.deleteSubscriber=function(e){var t=this.eventsOfSubscriber.get(e);if(void 0===t)return console.error("\u8be5\u8ba2\u9605\u8005\u6ca1\u6709\u8ba2\u9605\u4efb\u4f55\u4e8b\u4ef6"),!1;for(;t.length>0;)this.cancelSubscribe(e,t[0]);return!0},e.prototype.clearAllSubscribes=function(){this.eventSubscribeList=[],this.eventsOfSubscriber.clear()},e.prototype.findEventSubscribes=function(e){for(var t=null,o=0;o<this.eventSubscribeList.length;o++){var n=this.eventSubscribeList[o];if(n[0]===e){t=n[1];break}}return t},e.prototype.isSubscribed=function(e,t){var o=!1,n=this.eventsOfSubscriber.get(e);if(void 0!==n)for(var i=0;i<n.length;i++)if(n[i]===t){o=!0;break}return o},e.prototype.addSubscribEvents=function(e,t){var o=this.eventsOfSubscriber.get(e);if(void 0===o)(o=[]).push(t),this.eventsOfSubscriber.set(e,o);else{if(-1!==o.indexOf(t))return console.error("\u91cd\u590d\u8ba2\u9605\u4e8b\u4ef6"),!1;o.push(t)}return!0},e.prototype.deleteSubscribEvents=function(e,t){var o=this.eventsOfSubscriber.get(e);if(void 0!==o){for(var n=0;n<o.length;n++)if(o[n]===t)return void o.splice(n,1);console.error("\u5220\u9664\u6ca1\u6709\u8ba2\u9605\u7684\u4e8b\u4ef6")}else console.error("\u6ca1\u6709\u8ba2\u9605\u4efb\u52a1\u4e8b\u4ef6\uff0c\u8ba2\u9605\u8005\uff1a",e)},e}();o.default=i,cc._RF.pop()},{}],eventManager:[function(e,t,o){"use strict";cc._RF.push(t,"716489IJIxNW4lQF9s5QK9g","eventManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./eventCenter"),i=cc._decorator;i.ccclass,i.property;(function(e){e[e.InitModuleComplete=0]="InitModuleComplete",e[e.LoadTaskResListComplete=1]="LoadTaskResListComplete",e[e.LoadGameConfigComplete=2]="LoadGameConfigComplete",e[e.ResLoadComplete=3]="ResLoadComplete",e[e.GotOpenId=4]="GotOpenId",e[e.InitConfigComplete=5]="InitConfigComplete",e[e.InitUserDataComplete=6]="InitUserDataComplete",e[e.InitGameScene=7]="InitGameScene",e[e.ResetGame=8]="ResetGame",e[e.NextLevel=9]="NextLevel",e[e.PauseGame=10]="PauseGame",e[e.ContinueGame=11]="ContinueGame",e[e.LoadGameScene=12]="LoadGameScene",e[e.LoadIndexScene=13]="LoadIndexScene",e[e.LoginSuccess=14]="LoginSuccess",e[e.InitRankList=15]="InitRankList",e[e.OpenPanel=16]="OpenPanel",e[e.ClosePanel=17]="ClosePanel",e[e.OpenSelectLevelPanel=18]="OpenSelectLevelPanel",e[e.CloseSelectLevelPanel=19]="CloseSelectLevelPanel",e[e.OpenLoadPage=20]="OpenLoadPage",e[e.CloseLoadPage=21]="CloseLoadPage",e[e.UpdateProgress=22]="UpdateProgress",e[e.ShowFailPanel=23]="ShowFailPanel",e[e.ShowWinPanel=24]="ShowWinPanel",e[e.OpenCtrlPlayer=25]="OpenCtrlPlayer",e[e.CloseCtrlPlayer=26]="CloseCtrlPlayer",e[e.InitPlayer=27]="InitPlayer",e[e.InitPlayerComplete=28]="InitPlayerComplete",e[e.MoveButDown=29]="MoveButDown",e[e.MoveButUp=30]="MoveButUp",e[e.JumpButDown=31]="JumpButDown",e[e.hangeSpeedYPlayer=32]="hangeSpeedYPlayer",e[e.ChangeSpeedYPlayer=33]="ChangeSpeedYPlayer",e[e.ApplyImpulsionToPlayer=34]="ApplyImpulsionToPlayer",e[e.GivePlayerConstantSpeed=35]="GivePlayerConstantSpeed",e[e.RemovePlayerConstantSpeed=36]="RemovePlayerConstantSpeed",e[e.InVerMovedEntity=37]="InVerMovedEntity",e[e.ExitVerMovedEntiry=38]="ExitVerMovedEntiry",e[e.CanRotate=39]="CanRotate",e[e.Dead=40]="Dead",e[e.Win=41]="Win",e[e.StopCameraFollow=42]="StopCameraFollow",e[e.StartCameraFollow=43]="StartCameraFollow",e[e.CheckPlayerOutFace=44]="CheckPlayerOutFace",e[e.PlayerOutFace=45]="PlayerOutFace",e[e.InitCamera=46]="InitCamera",e[e.FruitMgrNotice=47]="FruitMgrNotice",e[e.DeleteFruit=48]="DeleteFruit",e[e.AddScore=49]="AddScore",e[e.MakeScore=50]="MakeScore",e[e.InitScoreMgr=51]="InitScoreMgr",e[e.ActiveRunBackGround=52]="ActiveRunBackGround"})(o.EventType||(o.EventType={}));var r=function(){function e(){this.eventCenter=new n.default}return e.init=function(){this.ins?console.warn("\u91cd\u590d\u521d\u59cb\u5316"):this.ins=new e},e.prototype.onEvent=function(e,t,o){this.eventCenter.addSubscribe(o,e.toString(),t)},e.prototype.onEventOnce=function(e,t,o){var n=this;this.eventCenter.addSubscribe(o,e.toString(),function(i){t.call(o,i),n.eventCenter.cancelSubscribe(o,e.toString())})},e.prototype.sendEvent=function(e,t){this.eventCenter.publishEvent(e.toString(),t)},e.prototype.deleteSubscriber=function(e){this.eventCenter.deleteSubscriber(e)},e}();o.default=r,cc._RF.pop()},{"./eventCenter":"eventCenter"}],fallState:[function(e,t,o){"use strict";cc._RF.push(t,"caca2dhTZBKEL5uLwk5Sovr","fallState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){this.player.climbWallEnable()?this.player.setState(i.default.climbWallState):this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.releaseMoveBut=function(){this.player.setSelfSpeed(0)},t.prototype.jumpBut=function(){1===this.property.getJumpCount()&&this.player.setState(i.default.doubleJumpState)},t.prototype.beginContact=function(){this.player.isLand()?0===this.property.isClickMoveBut?this.player.setState(i.default.idleState):this.player.setState(i.default.runState):this.player.climbWallEnable()&&this.player.setState(i.default.climbWallState)},t.prototype.endContact=function(){},t.prototype.downSpeed=function(){},t.prototype.upSpeed=function(){this.player.setState(i.default.upState)},t.prototype.impulsion=function(){},t.prototype.enter=function(){if(r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u5230\u4e0b\u843d\u72b6\u6001"),this.player.climbWallEnable())this.player.setState(i.default.climbWallState);else{this.player.anim.fall();var e=this.property.isClickMoveBut;0!==e&&this.player.setSelfSpeed(this.property.speedInAir*e)}},t.prototype.exit=function(){},t=__decorate([s],t)}(n.default));o.FallState=l,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../player":"player","./playerState":"playerState"}],fallingPf:[function(e,t,o){"use strict";cc._RF.push(t,"8560e9YGAFBpZ9/K8wpmFJ1","fallingPf"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../common/mathUtil"),r=e("../modules/eventManager/eventManager"),a=cc._decorator,s=a.ccclass,l=a.property;(function(e){e[e.fly=0]="fly",e[e.collide=1]="collide",e[e.fall=2]="fall"})(n||(n={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAtlas=null,t.offImg=null,t.particle=null,t.movedLen=10,t.rate=.5,t.t=2,t.anim=null,t.state=null,t.rigid=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.node.getComponent("frameAnim"),this.rigid=this.node.getComponent(cc.RigidBody),r.default.ins.onEvent(r.EventType.ContinueGame,this.fly,this)},t.prototype.start=function(){},t.prototype.onBeginContact=function(e,t,o){if(this.state!==n.fall){if("PLAYER"===o.node.group){if(1===i.default.relativeLocationVertical(t,o)&&(e.disabled=!0),this.state===n.collide)return;this.collide()}}else e.disabled=!0},t.prototype.fly=function(){this.node.stopAllActions(),this.on(),this.node.runAction(cc.sequence(cc.moveBy(this.rate,0,this.movedLen),cc.moveBy(2*this.rate,0,2*-this.movedLen),cc.moveBy(this.rate,0,this.movedLen)).repeatForever()),this.state=n.fly},t.prototype.collide=function(){this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveBy(.03,1,0),cc.moveBy(.06,-2,0),cc.moveBy(.03,1,0)).repeatForever()),this.scheduleOnce(this.fall,this.t),this.state=n.collide},t.prototype.fall=function(){var e=this;this.node.stopAllActions(),this.off(),this.state=n.fall,this.scheduleOnce(function(){e.destroy()},3),this.rigid.type=cc.RigidBodyType.Dynamic},t.prototype.on=function(){this.anim.setIdleImg(this.offImg),this.anim.setSpriteAtlas(this.onAtlas),this.anim.play(!0),this.particle.resetSystem()},t.prototype.off=function(){this.anim.stop(),this.particle.stopSystem()},__decorate([l(cc.SpriteAtlas)],t.prototype,"onAtlas",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"offImg",void 0),__decorate([l(cc.ParticleSystem)],t.prototype,"particle",void 0),__decorate([l()],t.prototype,"movedLen",void 0),__decorate([l({displayName:"\u6296\u52a8\u9891\u7387"})],t.prototype,"rate",void 0),__decorate([l({displayName:"\u652f\u6491\u65f6\u95f4"})],t.prototype,"t",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../common/mathUtil":"mathUtil","../modules/eventManager/eventManager":"eventManager"}],fire:[function(e,t,o){"use strict";cc._RF.push(t,"afeade5oo5OTJ58LlFqV9hu","fire"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/frameAnim"),i=e("../common/commonVar"),r=e("../common/mathUtil"),a=e("../modules/debugUtil"),s=e("../modules/eventManager/eventManager"),l=cc._decorator,c=l.ccclass,p=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openAtlas=null,t.offImg=null,t.onAtlas=null,t.anim=null,t.tOfOpen=1,t.dir=i.Dir.up,t.duration=2,t.debugUtil=a.default.ins,t.fireToCollider=null,t.isFire=!1,t.isOpen=!1,t.cT=0,t.rigid=null,t.collider=null,t.implusion=50,t.implusionOffset=10,t}return __extends(t,e),t.prototype.onLoad=function(){this.rigid=this.node.getComponent(cc.RigidBody),this.collider=this.node.getComponent(cc.PhysicsBoxCollider)},t.prototype.onBeginContact=function(e,t,o){"PLAYER"===o.node.group&&(1===t.tag?(this.debugUtil.log(a.DebugKey.Fire,"\u706b\u7130\u533a\u57df\u78b0\u649e\u5230\u4e86\u89d2\u8272"),this.fireToCollider=o,e.disabled=!0):0===t.tag&&(this.debugUtil.log(a.DebugKey.Fire,"\u975e\u706b\u7130\u533a\u57df\u78b0\u649e\u89d2\u8272"),this.isOpen||(this.isFire?this.cT=0:this.open())),this.fireToCollider&&(this.isFire?this.hitPlayer():this.open()))},t.prototype.onEndContact=function(e,t,o){"PLAYER"===o.node.group&&1===t.tag&&(this.debugUtil.log(a.DebugKey.Fire,"\u89d2\u8272\u79bb\u5f00\u975e\u706b\u7130\u533a\u57df"),this.fireToCollider=null)},t.prototype.open=function(){this.debugUtil.log(a.DebugKey.Fire,"\u6253\u5f00\u673a\u5173"),this.isOpen=!0,this.cT=0,this.anim.stop(),this.anim.setSpriteAtlas(this.openAtlas),this.anim.play(!0)},t.prototype.on=function(){this.debugUtil.log(a.DebugKey.Fire,"\u55b7\u706b"),this.isOpen=!1,this.isFire=!0,this.cT=0,this.anim.stop(),this.anim.setSpriteAtlas(this.onAtlas),this.anim.play(!0),this.fireToCollider&&this.hitPlayer()},t.prototype.off=function(){this.debugUtil.log(a.DebugKey.Fire,"\u5173\u95ed\u673a\u5173"),this.isFire=!1,this.cT=0,this.anim.stop(),this.anim.setSpriteFrame(this.offImg)},t.prototype.hitPlayer=function(){this.debugUtil.log(a.DebugKey.Fire,"\u653b\u51fb\u5230\u89d2\u8272");var e,t,o=new i.HitData,n=this.fireToCollider.getAABB(),l=this.collider.getAABB();switch(this.dir){case i.Dir.down:o.rotate=null,o.force=cc.v2(0,-this.implusion);break;case i.Dir.left:e=n.y+n.height/2,t=l.y+l.height/2,o.rotate=e>t?-r.default.getRandomInteger(30,45):r.default.getRandomInteger(30,45),o.force=cc.v2(-this.implusion,this.implusionOffset);break;case i.Dir.right:e=n.y+n.height/2,t=l.y+l.height/2,o.rotate=e>t?r.default.getRandomInteger(30,45):-r.default.getRandomInteger(30,45),o.force=cc.v2(this.implusion,this.implusionOffset);break;case i.Dir.up:(e=n.x+n.width/2)>(t=l.x+l.width/2)?(o.rotate=r.default.getRandomInteger(45,80),o.force=cc.v2(this.implusionOffset,this.implusion)):(o.rotate=-r.default.getRandomInteger(45,70),o.force=cc.v2(-this.implusionOffset,this.implusion))}s.default.ins.sendEvent(s.EventType.Dead,o)},t.prototype.update=function(e){this.isOpen?(this.cT+=e,this.cT>=this.tOfOpen&&this.on()):this.isFire&&(this.cT+=e,this.cT>=this.duration&&this.off())},__decorate([p(cc.SpriteAtlas)],t.prototype,"openAtlas",void 0),__decorate([p(cc.SpriteFrame)],t.prototype,"offImg",void 0),__decorate([p(cc.SpriteAtlas)],t.prototype,"onAtlas",void 0),__decorate([p(n.default)],t.prototype,"anim",void 0),__decorate([p({displayName:"\u6253\u5f00\u65f6\u95f4"})],t.prototype,"tOfOpen",void 0),__decorate([p({type:i.Dir,displayName:"\u55b7\u5c04\u65b9\u5411"})],t.prototype,"dir",void 0),__decorate([p({displayName:"\u55b7\u706b\u65f6\u95f4"})],t.prototype,"duration",void 0),t=__decorate([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../common/commonVar":"commonVar","../common/frameAnim":"frameAnim","../common/mathUtil":"mathUtil","../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager"}],frameAnim:[function(e,t,o){"use strict";cc._RF.push(t,"4c4692XGR9Bcae2Ky9aGB1i","frameAnim"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./myComponent"),i=cc._decorator,r=i.ccclass,a=i.property,s=i.disallowMultiple,l=i.menu,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playSpeed=.1,t.atlas=null,t.playOnLoad=!1,t.isLoop=!1,t.sprite=null,t.isPlay=!1,t.Index=-1,t.timeSum=0,t._spriteFrames=null,t.dir=1,t.isPuase=!1,t.callBack=null,t.idleImg=null,t}return __extends(t,e),t.prototype._onLoad=function(){this.sprite=this.node.getComponent(cc.Sprite),this.playOnLoad&&this.atlas&&(this.setSpriteAtlas(this.atlas),this.play(this.isLoop))},t.prototype.start=function(){},t.prototype.isPlaying=function(){return this.isPlay},t.prototype.setSpeed=function(e){this.playSpeed=e},t.prototype.setIdleImg=function(e){this.idleImg=e},t.prototype.setSpriteAtlas=function(e){this._spriteFrames=e.getSpriteFrames()},t.prototype.play=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=null),this.stop(),this.isLoop=e,this.dir=1,this.callBack=t,this.setSpriteFrame(this.getFrameFormArray()),this.isPlay=!0},t.prototype.stop=function(){this.isPlay&&(this.isPlay=!1,this.Index=-1,this.timeSum=0,this.isPuase=!1,this.callBack=null,this.idleImg&&this.setSpriteFrame(this.idleImg))},t.prototype.puase=function(){this.isPlay=!1,this.isPuase=!0},t.prototype.continue=function(){this.isPuase&&(this.isPlay=!0,this.isPuase=!1)},t.prototype.setSpriteFrame=function(e){this.sprite.spriteFrame=e},t.prototype.getFrameFormArray=function(){return this.Index+=this.dir,this.Index>=this._spriteFrames.length||this.Index<0?null:this._spriteFrames[this.Index]},t.prototype._update=function(e){if(this.isPlay&&(this.timeSum+=e,this.timeSum>=this.playSpeed)){this.timeSum=0;var t=this.getFrameFormArray();null===t?this.isLoop?this.Index=-1:(this.callBack&&this.callBack(),this.stop()):this.sprite.spriteFrame=t}},__decorate([a({displayName:"\u64ad\u653e\u901f\u5ea6",tooltip:"\u591a\u5c11\u79d2\u64ad\u653e\u4e00\u5e27"})],t.prototype,"playSpeed",void 0),__decorate([a(cc.SpriteAtlas)],t.prototype,"atlas",void 0),__decorate([a()],t.prototype,"playOnLoad",void 0),__decorate([a()],t.prototype,"isLoop",void 0),t=__decorate([r,s(),l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/FrameAnim")],t)}(n.default);o.default=c,cc._RF.pop()},{"./myComponent":"myComponent"}],fruitManager:[function(e,t,o){"use strict";cc._RF.push(t,"b4ade1qnAlDaJoAXhEaVNOg","fruitManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../modules/debugUtil"),i=e("../../common/mathUtil"),r=e("../../modules/eventManager/eventManager"),a=cc._decorator,s=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fruitAtlas=[],t.fruitPrefab=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.pool=new cc.NodePool,r.default.ins.onEvent(r.EventType.DeleteFruit,this.recoverFruitNode,this)},t.prototype.start=function(){r.default.ins.sendEvent(r.EventType.FruitMgrNotice,this)},t.prototype.createFruitRandom=function(){if(0===this.fruitAtlas.length)return console.error("\u6ca1\u6709\u6c34\u679c\u53ef\u4ee5\u751f\u6210"),null;var e=this.getFruitNode();this.node.addChild(e);var t=e.getComponent("fruit");return t.init(this.fruitAtlas[i.default.getRandomInteger(0,this.fruitAtlas.length-1)]),n.default.ins.log(n.DebugKey.FruitManager,"\u8282\u70b9\u6811\u4e2d\u52a0\u5165\u4e00\u4e2a\u6c34\u679c\uff01"),t},t.prototype.getFruitNode=function(){if(this.pool.size()>0){var e=this.pool.get();return e.opacity=255,e}return cc.instantiate(this.fruitPrefab)},t.prototype.recoverFruitNode=function(e){this.pool.put(e),n.default.ins.log(n.DebugKey.FruitManager,"\u56de\u6536\u4e00\u4e2a\u6c34\u679c\u8282\u70b9")},t.prototype.onDestroy=function(){r.default.ins.deleteSubscriber(this)},__decorate([l([cc.SpriteAtlas])],t.prototype,"fruitAtlas",void 0),__decorate([l(cc.Prefab)],t.prototype,"fruitPrefab",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil","../../modules/eventManager/eventManager":"eventManager"}],fruit:[function(e,t,o){"use strict";cc._RF.push(t,"54a23ToF0RO4ZJ9WOGt5Jnj","fruit"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/frameAnim"),i=e("../../modules/eventManager/eventManager"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameAnim=null,t.collectedAtlas=null,t.atlas=null,t.rigid=null,t.isCollected=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.rigid=this.node.getComponent(cc.RigidBody)},t.prototype.init=function(e){this.atlas=e,this.frameAnim.setSpriteAtlas(this.atlas),this.frameAnim.play(!0),this.isCollected=!1},t.prototype.setDynamic=function(){this.rigid.type=cc.RigidBodyType.Dynamic},t.prototype.onBeginContact=function(e,t,o){this.isCollected||"PLAYER"===o.node.group&&(i.default.ins.sendEvent(i.EventType.AddScore),this.collected(),this.isCollected=!0)},t.prototype.collected=function(){var e=this;this.frameAnim.stop(),this.frameAnim.setSpriteAtlas(this.collectedAtlas),this.frameAnim.play(!1,function(){i.default.ins.sendEvent(i.EventType.DeleteFruit,e.node)}.bind(this))},__decorate([s(n.default)],t.prototype,"frameAnim",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"collectedAtlas",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../common/frameAnim":"frameAnim","../../modules/eventManager/eventManager":"eventManager"}],gameScene:[function(e,t,o){"use strict";cc._RF.push(t,"905130hZSFOdZXnEcGk4Y8o","gameScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=e("../modules/debugUtil"),r=e("../modules/resManager/resManager"),a=e("../modules/global"),s=cc._decorator,l=s.ccclass,c=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameContent=null,t.levelPrefab=null,t}return __extends(t,e),t.prototype.onLoad=function(){n.default.ins.onEvent(n.EventType.PlayerOutFace,this.gameFail,this),n.default.ins.onEvent(n.EventType.LoadIndexScene,this.loadIndexScene,this),n.default.ins.onEvent(n.EventType.ResetGame,this.resetGame,this),n.default.ins.onEvent(n.EventType.NextLevel,this.nextLevel,this),this.createLevel()},t.prototype.start=function(){this.initGameScene(),this.scheduleOnce(function(){r.default.ins.outputCurResNum()},2)},t.prototype.initGameScene=function(){n.default.ins.sendEvent(n.EventType.InitCamera),n.default.ins.sendEvent(n.EventType.InitPlayer),n.default.ins.sendEvent(n.EventType.InitScoreMgr),n.default.ins.sendEvent(n.EventType.InitGameScene)},t.prototype.createLevel=function(){this.levelPrefab=r.default.ins.getRes("prefabs/levels/level"+a.default.ins.curLevelNum,cc.Prefab),this.gameContent.addChild(cc.instantiate(this.levelPrefab))},t.prototype.gameFail=function(){n.default.ins.sendEvent(n.EventType.ShowFailPanel)},t.prototype.loadIndexScene=function(){i.default.ins.log(i.DebugKey.GameLogic,"\u52a0\u8f7d\u4e3b\u9875\u573a\u666f"),r.default.ins.loadScene("indexScene","indexScene",function(){n.default.ins.sendEvent(n.EventType.ResLoadComplete)})},t.prototype.resetGame=function(){n.default.ins.sendEvent(n.EventType.StopCameraFollow);var e=this.gameContent.children[0];e.removeFromParent(),e.destroy(),this.gameContent.addChild(cc.instantiate(this.levelPrefab)),n.default.ins.sendEvent(n.EventType.InitPlayer),n.default.ins.sendEvent(n.EventType.InitScoreMgr),n.default.ins.sendEvent(n.EventType.InitGameScene),n.default.ins.sendEvent(n.EventType.InitCamera),n.default.ins.sendEvent(n.EventType.OpenCtrlPlayer),this.scheduleOnce(function(){r.default.ins.outputCurResNum()},2)},t.prototype.nextLevel=function(){var e=this;a.default.ins.curLevelNum++,n.default.ins.sendEvent(n.EventType.OpenLoadPage),r.default.ins.loadNextLevel("level"+a.default.ins.curLevelNum,function(){e.levelPrefab=r.default.ins.getRes("prefabs/levels/level"+a.default.ins.curLevelNum,cc.Prefab),e.resetGame(),n.default.ins.sendEvent(n.EventType.CloseLoadPage)})},t.prototype.onDestroy=function(){n.default.ins.deleteSubscriber(this)},__decorate([c(cc.Node)],t.prototype,"gameContent",void 0),t=__decorate([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager","../modules/global":"global","../modules/resManager/resManager":"resManager"}],game:[function(e,t,o){"use strict";cc._RF.push(t,"7730cofeaZD2qA/oF9JIPaR","game"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/debugUtil"),i=e("../modules/dataManager"),r=e("../modules/dataStorage"),a=e("../modules/eventManager/eventManager"),s=e("../modules/global"),l=e("../modules/UIHelper"),c=e("../modules/resManager/resManager"),p=e("../modules/soundManager"),u=cc._decorator,d=u.ccclass,h=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resUrl="json/resList",t}return __extends(t,e),t.prototype.onLoad=function(){s.default.ins.isSetup||(this.initModule(),this.loadGameConfig(),this.initFirstScene(),s.default.ins.isSetup=!0)},t.prototype.initModule=function(){a.default.init(),i.default.init(),n.default.init(),r.default.init(),l.default.init(),c.default.init(this.resUrl),p.default.init(),this.openDebugKey(),n.default.ins.log(n.DebugKey.GameLogic,"\u521d\u59cb\u5316\u6a21\u5757\u5b8c\u6210")},t.prototype.loadGameConfig=function(){a.default.ins.onEventOnce(a.EventType.LoadTaskResListComplete,function(){c.default.ins.excuteLoadTask("global","game",function(){n.default.ins.log(n.DebugKey.GameLogic,"\u52a0\u8f7d\u6e38\u620f\u914d\u7f6e\u4fe1\u606f\u548c\u6d4b\u8bd5\u7528\u6237\u6570\u636e\u5b8c\u6210"),a.default.ins.sendEvent(a.EventType.LoadGameConfigComplete)})},this)},t.prototype.initFirstScene=function(){a.default.ins.onEventOnce(a.EventType.LoadGameConfigComplete,function(){c.default.ins.initFirstScene("indexScene",function(){n.default.ins.log(n.DebugKey.GameLogic,"\u521d\u59cb\u5316\u9996\u573a\u666f\u5b8c\u6210"),a.default.ins.sendEvent(a.EventType.ResLoadComplete),a.default.ins.sendEvent(a.EventType.CloseLoadPage)})},this)},t.prototype.openDebugKey=function(){},t=__decorate([d],t)}(cc.Component));o.default=h,cc._RF.pop()},{"../modules/UIHelper":"UIHelper","../modules/dataManager":"dataManager","../modules/dataStorage":"dataStorage","../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager","../modules/global":"global","../modules/resManager/resManager":"resManager","../modules/soundManager":"soundManager"}],global:[function(e,t,o){"use strict";cc._RF.push(t,"d65e5g9mylP6JNpYIkxqENV","global"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.isSetup=!1,this.isFirstInitSelectPanel=!0}return e.ins=new e,e}();o.default=n,cc._RF.pop()},{}],horizelScrollView:[function(e,t,o){"use strict";cc._RF.push(t,"de405LQxDpOZLgRQGE2oJV1","horizelScrollView"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=n.disallowMultiple,s=n.menu,l=n.requireComponent,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.scrollEvents=[],t.page=null,t.scrollView=null,t.pages=null,t.virtualMode=!1,t.scrollThreshold=.4,t.turnPageTime=1,t.curIdx=0,t.maxIdx=0,t._curIdx=0,t._maxPageNum=3,t.stopDragInOverFace=!0,t}return __extends(t,e),t.prototype.onLoad=function(){this.scrollView=this.node.getComponent(cc.ScrollView),this.pages=this.content.children,this.onEvent()},t.prototype.onEvent=function(){this.node.on("touch-up",this.touchUp,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this)},t.prototype.init=function(e,t){this.page=e,this.curIdx=0,this.maxIdx=-1,this._curIdx=0,this.idxOfMedianPage=Math.floor(this._maxPageNum/2),this.initPosOfContent=this.content.getPosition(),this.pageWidth=this.page.data.width,this.PosOfMedianPage=this.getContentPos(this.idxOfMedianPage),this.setPageNum(t)},t.prototype.setPageNum=function(e){if(this.curIdx>e-1)console.error("\u65e0\u6cd5\u8bbe\u7f6e\u9875\u9762\u6570\u91cf\uff0c\u56e0\u4e3a\u8981\u5220\u9664\u7684\u9875\u9762\u4e2d\u6709\u6b63\u5728\u663e\u793a\u7684");else if(e!==this.getPageNum()){var t=e>this._maxPageNum?this._maxPageNum:e;this.pages.length!==t&&(this.pages.length>t?this.deletePages(this.pages.length-t):this.pages.length<t&&this.addPages(t-this.pages.length)),this.maxIdx=e-1,this.getPageNum()>this._maxPageNum&&!this.virtualMode&&this.openVirtualMode(),this.getPageNum()<=this._maxPageNum&&this.virtualMode&&this.closeVirtualMode()}},t.prototype.getPageNum=function(){return this.maxIdx+1},t.prototype.getPages=function(){return this.pages},t.prototype.horizelLayout=function(){var e;for(e=0;e<this.pages.length;e++)this.pages[e].setPosition(this.getPagePos(e))},t.prototype.getPagePos=function(e){return cc.v2(this.pageWidth/2+this.pageWidth*e)},t.prototype.addPages=function(e){var t;for(t=0;t<e;t++)this.content.addChild(cc.instantiate(this.page))},t.prototype.deletePages=function(e){var t,o=this.pages.length-1;for(t=0;t<e;t++)this.content.removeChild(this.pages[o])},t.prototype.openVirtualMode=function(){this.virtualMode=!0},t.prototype.closeVirtualMode=function(){this.virtualMode=!1},t.prototype.getContentPos=function(e){return cc.v2(this.initPosOfContent.x-this.pageWidth*e,this.initPosOfContent.y)},t.prototype.getPercent=function(e){return 0===e?0:e/(this.pages.length-1)},t.prototype.scrollToCurPage=function(){var e=this.content.getPosition(),t=Math.abs(this.getContentPos(this._curIdx).x-e.x)/this.pageWidth*this.turnPageTime;return this.scrollView.scrollToPercentHorizontal(this.getPercent(this._curIdx),t),t},t.prototype.needMovePage=function(e){var t,o;return-1===e?(t=this.curIdx,o=this._curIdx):1===e&&(t=this.maxIdx-this.curIdx,o=this.pages.length-1-this._curIdx),t>o},t.prototype.dealScroll=function(){var e=this,t=this.content.getPosition(),o=this.getContentPos(this._curIdx),n=t.x-o.x,i=Math.abs(n);if(i>this.pageWidth*this.scrollThreshold)if(n>0){if(0===this.curIdx)return;this.curIdx--,this._curIdx--;var r=this.scrollToCurPage();this.virtualMode&&this.needMovePage(-1)&&this._curIdx!==this.idxOfMedianPage&&this.scheduleOnce(function(){var t=e.pages.pop();e.pages.unshift(t),e.scrollView.setContentPosition(e.PosOfMedianPage),e.horizelLayout(),e.updatePageContent(t,e.curIdx-e.idxOfMedianPage),e._curIdx=e.idxOfMedianPage},r)}else{if(this.curIdx===this.maxIdx)return;this.curIdx++,this._curIdx++;r=this.scrollToCurPage();this.virtualMode&&this.needMovePage(1)&&this._curIdx!==this.idxOfMedianPage&&this.scheduleOnce(function(){var t=e.pages.shift();e.pages.push(t),e.scrollView.setContentPosition(e.getContentPos(1)),e.horizelLayout(),e.updatePageContent(t,e.curIdx+e.idxOfMedianPage),e._curIdx=e.idxOfMedianPage},r)}else{if(0===this.curIdx&&n>0||this.curIdx===this.maxIdx&&n<0)return;r=i/this.pageWidth*this.turnPageTime;this.scrollView.scrollToPercentHorizontal(this.getPercent(this._curIdx),r)}},t.prototype.updatePageContent=function(e,t){var o=new cc.Event.EventCustom("updatePageContent",!0);o.detail=[e,t],this.node.dispatchEvent(o)},t.prototype.touchUp=function(){this.dealScroll()},t.prototype.touchCancel=function(){console.log("touchCancel"),this.dealScroll()},t.prototype.scrollBegan=function(){console.log("scrollBegan")},t.prototype.scrollEnded=function(){console.log("scrollEnded")},t.prototype.update=function(e){},__decorate([r(cc.Node)],t.prototype,"content",void 0),__decorate([r({type:[cc.Component.EventHandler],displayName:"\u7ffb\u9875\u4e8b\u4ef6"})],t.prototype,"scrollEvents",void 0),t=__decorate([i,a(),s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/HorizelScrollView"),l(cc.ScrollView)],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],idleState:[function(e,t,o){"use strict";cc._RF.push(t,"8eefdZB2lpEoaD0XDk60DCe","idleState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){this.player.setState(i.default.runState)},t.prototype.releaseMoveBut=function(){},t.prototype.jumpBut=function(){this.player.setState(i.default.jumpState)},t.prototype.downSpeed=function(){},t.prototype.upSpeed=function(){this.player.setState(i.default.upState)},t.prototype.beginContact=function(){},t.prototype.endContact=function(){},t.prototype.impulsion=function(){},t.prototype.enter=function(){r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u5230\u5f85\u673a\u72b6\u6001"),this.player.anim.idle(),this.property.resetJumpCount()},t.prototype.exit=function(){this.player.anim.stop()},t=__decorate([s],t)}(n.default));o.IdleState=l,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../player":"player","./playerState":"playerState"}],indexScene:[function(e,t,o){"use strict";cc._RF.push(t,"fbf7drWAedO9qL8Uz0a6FEj","indexScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=e("../modules/global"),r=e("../modules/resManager/resManager"),a=e("../modules/debugUtil"),s=e("../modules/soundManager"),l=cc._decorator,c=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventMgr=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.eventMgr=n.default.ins,this.onEvent()},t.prototype.start=function(){this.scheduleOnce(function(){r.default.ins.outputCurResNum()},2),n.default.ins.sendEvent(n.EventType.OpenLoadPage)},t.prototype.onEvent=function(){this.eventMgr.onEventOnce(n.EventType.LoadGameScene,this.loadLevel,this),this.eventMgr.onEventOnce(n.EventType.LoadGameConfigComplete,function(){s.default.ins.playBGM("sounds/BGM.mp3")},this)},t.prototype.loadLevel=function(){var e="level"+i.default.ins.curLevelNum;a.default.ins.log(a.DebugKey.GameLogic,"\u52a0\u8f7d\u573a\u666f"+e),r.default.ins.loadScene("gameScene",e),n.default.ins.sendEvent(n.EventType.OpenLoadPage)},t.prototype.startBut=function(){this.eventMgr.sendEvent(n.EventType.OpenSelectLevelPanel)},t.prototype.backBut=function(){this.eventMgr.sendEvent(n.EventType.CloseSelectLevelPanel)},t=__decorate([c],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager","../modules/global":"global","../modules/resManager/resManager":"resManager","../modules/soundManager":"soundManager"}],jumpState:[function(e,t,o){"use strict";cc._RF.push(t,"7ba7cMOA/hJ+IilWU7is8vt","jumpState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=e("../../modules/soundManager"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.releaseMoveBut=function(){this.player.setSelfSpeed(0)},t.prototype.jumpBut=function(){this.player.setState(i.default.doubleJumpState)},t.prototype.downSpeed=function(){this.player.setState(i.default.fallState)},t.prototype.upSpeed=function(){this.player.setState(i.default.upState)},t.prototype.beginContact=function(){this.player.isLand()&&(0===this.property.isClickMoveBut?this.player.setState(i.default.idleState):this.player.setState(i.default.runState))},t.prototype.endContact=function(){},t.prototype.impulsion=function(){},t.prototype.enter=function(){r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u8df3\u8dc3\u72b6\u6001"),a.default.ins.playEffect("sounds/jump"),this.property.addJumpCount(),this.player.anim.jump(),this.player.applyImpulsion(cc.v2(0,this.property.jumpForce));var e=this.property.isClickMoveBut;0!==e&&this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.exit=function(){},t=__decorate([l],t)}(n.default));o.JumpState=c,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../../modules/soundManager":"soundManager","../player":"player","./playerState":"playerState"}],keyControl:[function(e,t,o){"use strict";cc._RF.push(t,"7db75oBwftHDZQfIWsVdXMs","keyControl"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=cc._decorator,r=i.ccclass,a=(i.property,i.disallowMultiple),s=i.menu,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isCtrl=!0,t}return __extends(t,e),t.prototype.start=function(){var e=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),n.default.ins.onEvent(n.EventType.CloseCtrlPlayer,function(){e.isCtrl=!1},this),n.default.ins.onEvent(n.EventType.OpenCtrlPlayer,function(){e.isCtrl=!0},this)},t.prototype.onKeyDown=function(e){if(this.isCtrl)switch(e.keyCode){case cc.macro.KEY.left:n.default.ins.sendEvent(n.EventType.MoveButDown,-1);break;case cc.macro.KEY.right:n.default.ins.sendEvent(n.EventType.MoveButDown,1);break;case cc.macro.KEY.space:n.default.ins.sendEvent(n.EventType.JumpButDown)}},t.prototype.onKeyUp=function(e){if(this.isCtrl)switch(e.keyCode){case cc.macro.KEY.left:n.default.ins.sendEvent(n.EventType.MoveButUp,-1);break;case cc.macro.KEY.right:n.default.ins.sendEvent(n.EventType.MoveButUp,1)}},t.prototype.onDestroy=function(){n.default.ins.deleteSubscriber(this)},t=__decorate([r,a,s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/KeyControl")],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../modules/eventManager/eventManager":"eventManager"}],level:[function(e,t,o){"use strict";cc._RF.push(t,"79d3ewfoSdP9LaKb/GEr+iA","level"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../modules/eventManager/eventManager"),i=e("../../modules/global"),r=e("../../modules/resManager/resManager"),a=cc._decorator,s=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelNum=null,t.button=null,t.starPs=[],t.starArr=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.resMgr=r.default.ins,this.setClickEvent()},t.prototype.init=function(e,t,o){void 0===o&&(o=0),this.num=e,this.star=this.resMgr.getRes("prefabs/ui/selectPanel/star",cc.Prefab),this.levelNum.string=e.toString(),!1===t&&(this.button.interactable=!1),o>3?console.error("\u4fe1\u606f\u6570\u91cf\u9519\u8bef"):this.showStar(o)},t.prototype.showStar=function(e){for(var t,o;this.starArr.length<e;)o=this._getStar(),t=this.starArr.push(o)-1,o.setPosition(this.starPs[t]);for(t=0;t<this.starArr.length;t++)this.starArr[t].active=t+1<=e;this.starNum=e},t.prototype._getStar=function(){var e=cc.instantiate(this.star);return this.node.addChild(e),e},t.prototype.setClickEvent=function(){if(this.button.clickEvents.length>0)console.error("\u5df2\u6709\u70b9\u51fb\u4e8b\u4ef6");else{var e=new cc.Component.EventHandler;e.target=this.node,e.component="level",e.handler="clickEvent",this.button.clickEvents.push(e)}},t.prototype.clickEvent=function(){console.log("\u70b9\u51fb\u5173\u5361"+this.num),i.default.ins.curLevelNum=this.num,n.default.ins.sendEvent(n.EventType.LoadGameScene)},__decorate([l(cc.Label)],t.prototype,"levelNum",void 0),__decorate([l(cc.Button)],t.prototype,"button",void 0),__decorate([l({type:[cc.Vec2],tooltip:"3\u4e2a\u661f\u661f\u7684\u5750\u6807"})],t.prototype,"starPs",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../modules/eventManager/eventManager":"eventManager","../../modules/global":"global","../../modules/resManager/resManager":"resManager"}],loadPage:[function(e,t,o){"use strict";cc._RF.push(t,"1b1e3bM5wJL/rC3KsmxPu5v","loadPage"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=e("../modules/debugUtil"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bar=null,t}return __extends(t,e),t.prototype.onLoad=function(){n.default.ins.onEvent(n.EventType.OpenLoadPage,this.open,this),n.default.ins.onEvent(n.EventType.CloseLoadPage,this.close,this),n.default.ins.onEvent(n.EventType.UpdateProgress,this.updateProgressBar,this),this.init()},t.prototype.init=function(){this.node.setPosition(cc.v2()),this.node.active=!1},t.prototype.open=function(){this.bar.progress=0,n.default.ins.sendEvent(n.EventType.OpenPanel,this.node)},t.prototype.close=function(){n.default.ins.sendEvent(n.EventType.ClosePanel,this.node)},t.prototype.updateProgressBar=function(e){this.bar.progress=e,i.default.ins.log(i.DebugKey.LoadPage,"\u52a0\u8f7d\u8fdb\u5ea6\uff1a"+e)},t.prototype.onDestroy=function(){n.default.ins.deleteSubscriber(this)},__decorate([s(cc.ProgressBar)],t.prototype,"bar",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager"}],loadProgress:[function(e,t,o){"use strict";cc._RF.push(t,"3d920BMmKdIS74gZYFZDQ2X","loadProgress"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../eventManager/eventManager"),i=function(){function e(){this.loadResArr=[],this.p=0}return e.prototype.registerLoad=function(){return this.loadResArr[this.p]=0,this.p++},e.prototype.updateLoadState=function(e,t,o){o&&(this.loadResArr[e]=t/o,1===this.loadResArr[e]&&(this.loadResArr[e]-=.01),n.default.ins.sendEvent(n.EventType.UpdateProgress,this.getloadedRate()))},e.prototype.completeId=function(e){this.loadResArr[e]=1},e.prototype.isLoadComplete=function(){n.default.ins.sendEvent(n.EventType.UpdateProgress,this.getloadedRate());for(var e=!0,t=0;t<this.p;t++)if(1!==this.loadResArr[t]){e=!1;break}return e},e.prototype.clearRecord=function(){this.p=0},e.prototype.getloadedRate=function(){var e=0;return this.loadResArr.forEach(function(t){e+=t}),e/this.loadResArr.length},e}();o.default=i,cc._RF.pop()},{"../eventManager/eventManager":"eventManager"}],mathUtil:[function(e,t,o){"use strict";cc._RF.push(t,"9a9edc9jjJOJL4WnlRl7ziP","mathUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./commonVar"),i=function(){function e(){}return e.sumOfArray=function(e){for(var t=0,o=0,n=e;o<n.length;o++){t+=n[o]}return t},e.removeItemFromArray=function(e,t){var o=t.indexOf(e);t.splice(o,1)},e.getWorldCoordinate=function(e){return e.convertToWorldSpaceAR(cc.v2(0,0))},e.getNodePFromWP=function(e,t){return e.convertToNodeSpaceAR(t)},e.getRandomInteger=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},e.relativeLocationHoriz=function(e,t,o){void 0===o&&(o=3);var n=0,i=e.getAABB(),r=i,a=i=t.getAABB();return r.yMin>=a.yMax||r.yMax<=a.yMin?n=0:Math.abs(r.xMax-a.xMin)<o?n=-1:Math.abs(r.xMin-a.xMax)<o&&(n=1),n},e.relativeLocationVertical=function(e,t,o){void 0===o&&(o=3);var n=0,i=e.getAABB(),r=i,a=i=t.getAABB();return r.xMax<=a.xMin||r.xMin>=a.xMax?n=0:Math.abs(r.yMax-a.yMin)<o?n=-1:Math.abs(r.yMin-a.yMax)<o&&(n=1),n},e.getRelativeDir=function(e,t){var o=e.getAABB(),i=o,r=o=t.getAABB();return this.inRow(i,r)?i.x<r.x?n.DIR.left:n.DIR.right:this.inColumn(i,r)?i.y<r.y?n.DIR.down:n.DIR.up:null},e.isSide=function(e,t,o){var i=e.getAABB(),r=i,a=i=t.getAABB();switch(o){case n.DIR.down:if(this.inColumn(r,a)&&r.center.y<a.center.y)return!0;break;case n.DIR.up:if(this.inColumn(r,a)&&r.center.y>a.center.y)return!0;break;case n.DIR.left:if(this.inRow(r,a)&&r.center.x<a.center.x)return!0;break;case n.DIR.right:if(this.inRow(r,a)&&r.center.x>a.center.x)return!0}return!1},e.inRow=function(e,t){return!(e.yMax<=t.yMin+3||e.yMin>=t.yMax-3)},e.inColumn=function(e,t){return!(e.xMin>=t.xMax-3||e.xMax<=t.xMin+3)},e.getRandomForce=function(t,o,n,i){var r=e.getRandomInteger(t,o),a=e.getRandomInteger(n,i),s=r*Math.cos(a),l=r*Math.sin(a);return cc.v2(s,l)},e.getRandomSelect=function(){return Math.random()>.5?1:-1},e.lenOfObject=function(e){var t,o=0;for(t in e)o++;return o},e}();o.default=i,cc._RF.pop()},{"./commonVar":"commonVar"}],movedPlatformBg:[function(e,t,o){"use strict";cc._RF.push(t,"4371e+eKE1LjJG4JCbXKCVG","movedPlatformBg"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/frameAnim"),i=e("../../modules/debugUtil"),r=e("../../common/mathUtil"),a=e("../../common/commonVar"),s=cc._decorator,l=s.ccclass,c=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t.rigid=null,t.isPlayerUnder=!1,t.isContactBottom=!1,t.record=null,t.self=null,t.player=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.rigid=this.node.getComponent(cc.RigidBody),this.self=this.node.getComponent(cc.PhysicsBoxCollider)},t.prototype.onBeginContact=function(e,t,o){if("PLAYER"===o.node.group&&!this.isPlayerUnder&&r.default.inColumn(o.getAABB(),t.getAABB())){var n=o.getAABB(),s=n.center,l=(n=t.getAABB()).center;if(s.y>l.y){i.default.ins.log(i.DebugKey.MovedPlatformBg,"\u89d2\u8272\u5230\u5e73\u53f0\u4e0a"),this.player||(this.player=o),this.isPlayerUnder=!0;var c=new cc.Event.EventCustom("playerUnderPlatform",!0);c.detail=new a.ContactInfo(e,t,o),this.node.dispatchEvent(c)}else this.rigid.linearVelocity.y<0&&Math.abs(this.getVelocityOfCollider(o).y)<3&&(i.default.ins.log(i.DebugKey.MovedPlatformBg,"\u65e0\u6c34\u5e73\u901f\u5ea6\u7684\u89d2\u8272\u5728\u5411\u4e0b\u79fb\u52a8\u7684\u5e73\u53f0\u4e0b\u65b9\u5e76\u76f8\u9047\uff0c\u505c\u6b62\u5e73\u53f0\u79fb\u52a8"),this.isContactBottom=!0,this.record=this.rigid.linearVelocity,this.rigid.linearVelocity=cc.v2())}},t.prototype._onEndContact=function(e,t,o){i.default.ins.log(i.DebugKey.MovedPlatformBg,"\u89d2\u8272\u79bb\u5f00\u5e73\u53f0\u4e4b\u4e0a"),this.isPlayerUnder=!1;var n=new cc.Event.EventCustom("exitUnderPlatform",!0);n.detail=new a.ContactInfo(e,t,o),this.node.dispatchEvent(n)},t.prototype.getVelocityOfCollider=function(e){return e.node.getComponent(cc.RigidBody).linearVelocity},t.prototype.update=function(){if(this.isPlayerUnder)a.OnEndContact(this.self,this.player)&&this._onEndContact(null,this.self,this.player);else if(this.isContactBottom){var e=this.self.getAABB(),t=this.player.getAABB();(t.x+t.width<=e.x||t.x>=e.x+e.width)&&(i.default.ins.log(i.DebugKey.MovedPlatformBg,"\u89d2\u8272\u79bb\u5f00\u5e73\u53f0\u4e0b\u65b9\uff0c\u7ee7\u7eed\u79fb\u52a8\u5e73\u53f0"),this.rigid.linearVelocity=this.record,this.isContactBottom=!1)}},__decorate([c(n.default)],t.prototype,"anim",void 0),t=__decorate([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../common/commonVar":"commonVar","../../common/frameAnim":"frameAnim","../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil"}],movedPlatform:[function(e,t,o){"use strict";cc._RF.push(t,"2b8adcTVc5H6L21rYLh00wu","movedPlatform"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/commonVar"),i=e("./movedPlatformBg"),r=e("../../modules/debugUtil"),a=e("../../modules/eventManager/eventManager"),s=cc._decorator,l=s.ccclass,c=s.property,p=cc.Enum({auto:0,trigger:1}),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.platform=null,t.onAtlas=null,t.offImg=null,t.movedDir=n.Dir.left,t.mode=p.auto,t.startP=cc.v2(0,0),t.endP=cc.v2(0,0),t.speed=5,t.dockingT=2,t.isHorizMove=null,t.speedToEndP=null,t.isToEndP=1,t.isDocking=!1,t.ct=0,t}return __extends(t,e),t.prototype.onLoad=function(){a.default.ins.onEventOnce(a.EventType.InitGameScene,this.startup,this),this.node.on("playerUnderPlatform",this._playerUnderPlatform,this),this.node.on("exitUnderPlatform",this._exitUnderPlatform,this),this.dealAgrs(),this.initPlatform()},t.prototype.start=function(){},t.prototype.startup=function(){this.mode===p.auto?(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u81ea\u52a8\u6a21\u5f0f\u4e0b\uff0c\u5e73\u53f0\u5f00\u59cb\u79fb\u52a8"),this.isToEndP=1,this.refreshVelocity(),this.isDocking=!1):this.isDocking=!0},t.prototype.initPlatform=function(){this.platform.node.setPosition(this.startP),this.platform.anim.setSpriteAtlas(this.onAtlas),this.platform.anim.setIdleImg(this.offImg),-1===[n.Dir.right,n.Dir.left].indexOf(this.movedDir)?this.isHorizMove=!1:this.isHorizMove=!0},t.prototype.dealAgrs=function(){switch(this.movedDir){case n.Dir.down:this.isHorizMove=!1,this.speedToEndP=-this.speed;break;case n.Dir.up:this.isHorizMove=!1,this.speedToEndP=this.speed;break;case n.Dir.left:this.isHorizMove=!0,this.speedToEndP=-this.speed;break;case n.Dir.right:this.isHorizMove=!0,this.speedToEndP=this.speed}},t.prototype._playerUnderPlatform=function(e){e.stopPropagation(),this._dealBeginContact()},t.prototype._dealBeginContact=function(){this.mode===p.auto?this.isDocking||(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u5904\u4e8e\u81ea\u52a8\u6a21\u5f0f\uff0c\u5e73\u53f0\u5728\u79fb\u52a8"),this.affectPlayer()):(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u5904\u4e8e\u89e6\u53d1\u6a21\u5f0f\uff0c\u8ba9\u5e73\u53f0\u5411\u7ec8\u70b9\u79fb\u52a8"),this.isToEndP=1,this.refreshVelocity(),this.isDocking=!1,this.affectPlayer())},t.prototype._exitUnderPlatform=function(e){e.stopPropagation(),this.mode===p.auto?this.isDocking||(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u5904\u4e8e\u81ea\u52a8\u6a21\u5f0f\uff0c\u5e73\u53f0\u5728\u79fb\u52a8"),this.removeAffectToPlayer()):(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u8ba9\u5e73\u53f0\u5411\u8d77\u70b9\u79fb\u52a8"),this.isToEndP=-1,this.refreshVelocity(),this.isDocking=!1,this.removeAffectToPlayer())},t.prototype.affectPlayer=function(){this.isHorizMove?(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u7ed9\u89d2\u8272\u52a0\u4e0a\u5e73\u53f0\u6c34\u5e73\u901f\u5ea6"),a.default.ins.sendEvent(a.EventType.GivePlayerConstantSpeed,new n.GiveExtraSpeed("movedPlatformBg",this.platform.rigid.linearVelocity))):(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u544a\u8bc9\u89d2\u8272\u4f60\u5904\u4e8e\u5782\u76f4\u79fb\u52a8\u5e73\u53f0\u4e0a"),a.default.ins.sendEvent(a.EventType.InVerMovedEntity))},t.prototype.removeAffectToPlayer=function(){this.isHorizMove?(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u79fb\u9664\u5bf9\u89d2\u8272\u6c34\u5e73\u901f\u5ea6\u7684\u5f71\u54cd"),a.default.ins.sendEvent(a.EventType.RemovePlayerConstantSpeed,"movedPlatformBg")):(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u544a\u8bc9\u89d2\u8272\u4f60\u79bb\u5f00\u4e86\u5782\u76f4\u79fb\u52a8\u7684\u5e73\u53f0"),a.default.ins.sendEvent(a.EventType.ExitVerMovedEntiry))},t.prototype.refreshVelocity=function(){this.isHorizMove?this.platform.rigid.linearVelocity=cc.v2(this.speedToEndP*this.isToEndP,0):this.platform.rigid.linearVelocity=cc.v2(0,this.speedToEndP*this.isToEndP)},t.prototype.dockEnable=function(){var e=!1,t=this.platform.node.getPosition();switch(this.movedDir){case n.Dir.down:(1===this.isToEndP&&t.y<=this.endP.y||-1===this.isToEndP&&t.y>=this.startP.y)&&(e=!0);break;case n.Dir.up:(1===this.isToEndP&&t.y>=this.endP.y||-1===this.isToEndP&&t.y<=this.startP.y)&&(e=!0);break;case n.Dir.left:(1===this.isToEndP&&t.x<=this.endP.x||-1===this.isToEndP&&t.x>=this.startP.x)&&(e=!0);break;case n.Dir.right:(1===this.isToEndP&&t.x>=this.endP.x||-1===this.isToEndP&&t.x<=this.startP.x)&&(e=!0)}return e},t.prototype.update=function(e){this.platform.isContactBottom||(this.mode===p.auto?this.isDocking?(this.ct+=e,this.ct>=this.dockingT&&(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u81ea\u52a8\u6a21\u5f0f\u4e0b\uff0c\u505c\u9760\u7ed3\u675f\u3002\u5411\u53e6\u4e00\u7aef\u79fb\u52a8"),this.isDocking=!1,this.ct=0,this.isToEndP=-this.isToEndP,this.refreshVelocity(),this.platform.isPlayerUnder&&(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u89d2\u8272\u5728\u5e73\u53f0\u4e0a"),this.isHorizMove&&(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u7ed9\u89d2\u8272\u52a0\u4e0a\u5e73\u53f0\u6c34\u5e73\u901f\u5ea6"),a.default.ins.sendEvent(a.EventType.GivePlayerConstantSpeed,new n.GiveExtraSpeed("movedPlatformBg",this.platform.rigid.linearVelocity)))))):this.dockEnable()&&(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u53ef\u4ee5\u505c\u9760\uff0c\u505c\u6b62\u79fb\u52a8"),this.isDocking=!0,this.platform.rigid.linearVelocity=cc.v2(0,0),this.platform.isPlayerUnder&&this.isHorizMove&&(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u6709\u89d2\u8272\u5728\u5e73\u53f0\u4e0a\uff0c\u79fb\u9664\u5bf9\u89d2\u8272\u6c34\u5e73\u901f\u5ea6\u7684\u5f71\u54cd"),a.default.ins.sendEvent(a.EventType.RemovePlayerConstantSpeed,"movedPlatformBg"))):!this.isDocking&&this.dockEnable()&&(r.default.ins.log(r.DebugKey.MovedPlatformBg,"\u8fbe\u5230\u8def\u5f84\u7aef\u70b9\uff0c\u505c\u6b62\u79fb\u52a8"),this.isHorizMove&&a.default.ins.sendEvent(a.EventType.RemovePlayerConstantSpeed,"movedPlatformBg"),this.isDocking=!0,this.platform.rigid.linearVelocity=cc.v2(0,0)))},__decorate([c(i.default)],t.prototype,"platform",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"onAtlas",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"offImg",void 0),__decorate([c({type:n.Dir,displayName:"\u5f00\u59cb\u79fb\u52a8\u65b9\u5411"})],t.prototype,"movedDir",void 0),__decorate([c({type:p,displayName:"\u79fb\u52a8\u6a21\u5f0f"})],t.prototype,"mode",void 0),__decorate([c({displayName:"\u79fb\u52a8\u8d77\u70b9",tooltip:"movedPlatform\u4e0b\u7684\u8282\u70b9\u5750\u6807"})],t.prototype,"startP",void 0),__decorate([c({displayName:"\u79fb\u52a8\u7ec8\u70b9",tooltip:"movedPlatform\u4e0b\u7684\u8282\u70b9\u5750\u6807"})],t.prototype,"endP",void 0),__decorate([c({displayName:"\u79fb\u52a8\u901f\u5ea6"})],t.prototype,"speed",void 0),__decorate([c({tooltip:"\u5728\u81ea\u52a8\u6a21\u5f0f\u4e2d\uff0c\u5728\u7aef\u70b9\u7684\u505c\u9760\u65f6\u95f4"})],t.prototype,"dockingT",void 0),t=__decorate([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../common/commonVar":"commonVar","../../modules/debugUtil":"debugUtil","../../modules/eventManager/eventManager":"eventManager","./movedPlatformBg":"movedPlatformBg"}],myComponent:[function(e,t,o){"use strict";cc._RF.push(t,"d7eecoSDmJMeZfdbas7QeC1","myComponent"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gamePause=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this._onLoad()},t.prototype.update=function(e){this.gamePause||this._update(e)},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],oneWayPlatform:[function(e,t,o){"use strict";cc._RF.push(t,"d1f5aRUIyhKNZz/kn6kCFAU","oneWayPlatform"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/mathUtil"),i=cc._decorator,r=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){"PLAYER"===o.node.group&&1===n.default.relativeLocationVertical(t,o)&&(e.disabled=!0)},t=__decorate([r],t)}(cc.Component));o.default=a,cc._RF.pop()},{"../common/mathUtil":"mathUtil"}],openPhysicsEngine:[function(e,t,o){"use strict";cc._RF.push(t,"72d28PS1S1OeIG4UnDCTbxa","openPhysicsEngine"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isDebug=!1,t.gravity=new cc.Vec2(0,0),t}return __extends(t,e),t.prototype.onLoad=function(){this.pMgr=cc.director.getPhysicsManager(),this.pMgr.enabled=!0,this.debug(),this.pMgr.gravity=this.gravity},t.prototype.debug=function(){if(this.isDebug){var e=cc.PhysicsManager.DrawBits;this.pMgr.debugDrawFlags=e.e_jointBit|e.e_shapeBit|e.e_centerOfMassBit}else this.pMgr.debugDrawFlags=0},__decorate([r({})],t.prototype,"isDebug",void 0),__decorate([r({})],t.prototype,"gravity",void 0),t=__decorate([i],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],page:[function(e,t,o){"use strict";cc._RF.push(t,"2b6e9XqJ3tK+axeXsJBcRZP","page"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../modules/dataManager"),i=e("../../modules/resManager/resManager"),r=cc._decorator,a=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelPre=null,t.dataMgr=null,t.resMgr=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.dataMgr=n.default.ins,this.resMgr=i.default.ins,this.levelPre=this.resMgr.getRes("prefabs/ui/selectPanel/level",cc.Prefab)},t.prototype.init=function(e,t){var o,n,i,r=this.dataMgr.passLevelSum;for(o=e;o<=t;o++){o<=r+1?(n=!0,i=o===r+1?0:this.dataMgr.getLeveledStarN(o)):n=!1,this.createLevel().init(o,n,i)}},t.prototype.createLevel=function(){var e=cc.instantiate(this.levelPre);return this.node.addChild(e),e.getComponent("level")},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../modules/dataManager":"dataManager","../../modules/resManager/resManager":"resManager"}],playerAnim:[function(e,t,o){"use strict";cc._RF.push(t,"ca2b7SuZiBA0ZfiaN8X5SoY","playerAnim"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/frameAnim"),i=e("../modules/eventManager/eventManager"),r=e("../modules/resManager/resManager"),a=cc._decorator,s=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameAnim=null,t.doubleJumpAtlas=null,t.hitAtlas=null,t.idleAtlas=null,t.runAtlas=null,t.walkWallAtlas=null,t.fallImg=null,t.jumpImg=null,t.appearingAtlas=null,t.desappearingAtlas=null,t.resMgr=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.resMgr=r.default.ins},t.prototype.init=function(){this.frameAnim.setSpriteFrame(this.idleAtlas.getSpriteFrames()[0])},t.prototype.run=function(){this.frameAnim.setSpriteAtlas(this.runAtlas),this.frameAnim.play(!0)},t.prototype.jump=function(){this.frameAnim.setSpriteFrame(this.jumpImg)},t.prototype.doubleJump=function(){this.frameAnim.setSpriteAtlas(this.doubleJumpAtlas),this.frameAnim.play()},t.prototype.fall=function(){this.frameAnim.setSpriteFrame(this.fallImg)},t.prototype.idle=function(){this.frameAnim.setSpriteAtlas(this.idleAtlas),this.frameAnim.play(!0)},t.prototype.climbWall=function(){this.frameAnim.setSpriteAtlas(this.walkWallAtlas),this.frameAnim.play(!0)},t.prototype.up=function(){this.frameAnim.setSpriteFrame(this.jumpImg)},t.prototype.dead=function(e){this.frameAnim.setSpriteAtlas(this.hitAtlas),this.frameAnim.play(),e&&(e.force&&i.default.ins.sendEvent(i.EventType.ApplyImpulsionToPlayer,e.force),e.rotate&&cc.tween(this.node).by(.3,{angle:e.rotate}).start())},t.prototype.appearing=function(e){this.frameAnim.setSpriteAtlas(this.appearingAtlas),this.frameAnim.play(!1,e)},t.prototype.desappearing=function(e){this.frameAnim.setSpriteAtlas(this.desappearingAtlas),this.frameAnim.play(!1,e)},t.prototype.isPlay=function(){return this.frameAnim.isPlaying()},t.prototype.stop=function(){this.frameAnim.stop()},__decorate([l(n.default)],t.prototype,"frameAnim",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"doubleJumpAtlas",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"hitAtlas",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"idleAtlas",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"runAtlas",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"walkWallAtlas",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"fallImg",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"jumpImg",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"appearingAtlas",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"desappearingAtlas",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../common/frameAnim":"frameAnim","../modules/eventManager/eventManager":"eventManager","../modules/resManager/resManager":"resManager"}],playerState:[function(e,t,o){"use strict";cc._RF.push(t,"49dc6nEuzVJqYMKVt+vDJKu","playerState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../player"),i=function(){function e(){}return e.prototype.setPlayer=function(e){this.player=e,this.property=e.property},e.prototype.dead=function(){this.player.setState(n.default.deadState)},e}();o.default=i,cc._RF.pop()},{"../player":"player"}],player:[function(e,t,o){"use strict";cc._RF.push(t,"bcc26UYbEJHbYdxn8ddzDxO","player"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerAnim"),i=e("../common/mathUtil"),r=e("./playerState/deadState"),a=e("./playerState/doubleJumpState"),s=e("./playerState/fallState"),l=e("./playerState/idleState"),c=e("./playerState/jumpState"),p=e("./playerState/runState"),u=e("./playerState/upState"),d=e("./playerState/climbWallState"),h=e("./property"),f=e("../modules/eventManager/eventManager"),y=e("../modules/debugUtil"),m=e("../modules/soundManager"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t.property=new h.default,t.rigid=null,t.collider=null,t.selfSpeed=0,t.updateSpeed=!0,t.isUpdate=!0,t.inVerMovedEntity=!1,t}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){this.rigid=this.node.getComponent(cc.RigidBody),this.collider=this.node.getComponent(cc.PhysicsBoxCollider),this.onEvent()},t.prototype.onEvent=function(){var e=this;f.default.ins.onEventOnce(f.EventType.InitPlayer,this.initPlayer,this),f.default.ins.onEvent(f.EventType.MoveButDown,this.moveBut,this),f.default.ins.onEvent(f.EventType.MoveButUp,this.releaseMoveBut,this),f.default.ins.onEvent(f.EventType.JumpButDown,this.jumpBut,this),f.default.ins.onEvent(f.EventType.ChangeSpeedYPlayer,this.setSpeedY,this),f.default.ins.onEvent(f.EventType.ApplyImpulsionToPlayer,this.applyImpulsion,this),f.default.ins.onEvent(f.EventType.GivePlayerConstantSpeed,this.setConstantSpeed,this),f.default.ins.onEvent(f.EventType.RemovePlayerConstantSpeed,this.removeConstantSpeed,this),f.default.ins.onEvent(f.EventType.Dead,this.dead,this),f.default.ins.onEvent(f.EventType.Win,this.win,this),f.default.ins.onEvent(f.EventType.InVerMovedEntity,function(){e.inVerMovedEntity=!0},this),f.default.ins.onEvent(f.EventType.ExitVerMovedEntiry,function(){e.inVerMovedEntity=!1},this),f.default.ins.onEvent(f.EventType.CanRotate,function(){e.rigid.fixedRotation=!1},this)},t.prototype.init=function(){this.property.init(),this.selfSpeed=0,this.updateSpeed=!0,this.isUpdate=!0,this.inVerMovedEntity=!1,this.state=o.fallState,this.state.setPlayer(this),this.state.enter()},t.prototype.setState=function(e){this.state.exit(),this.state=e,this.state.setPlayer(this),this.state.enter()},t.prototype.getState=function(){return this.state},t.prototype.setSelfSpeed=function(e){this.selfSpeed=e},t.prototype.initPlayer=function(){var e=this;this.anim.init(),this.init(),this.anim.appearing(function(){e.anim.fall(),e.rigid.gravityScale=1}.bind(this))},t.prototype.setConstantSpeed=function(e){this.property.recordExtraSpeed(e)},t.prototype.removeConstantSpeed=function(e){this.property.removeExtraSpeed(e)},t.prototype.win=function(){var e=this;f.default.ins.sendEvent(f.EventType.CloseCtrlPlayer),this.rigid.linearVelocity=cc.v2(),this.state=o.deadState,this.anim.jump(),this.applyImpulsion(cc.v2(0,55)),this.isUpdate=!1,this.scheduleOnce(function(){e.rigid.linearVelocity.y=0,e.rigid.gravityScale=0,e.anim.desappearing(function(){e.node.active=!1,f.default.ins.sendEvent(f.EventType.MakeScore)})},.6)},t.prototype.moveBut=function(e){y.default.ins.log(y.DebugKey.ClickButton,"\u70b9\u51fb\u79fb\u52a8\u6309\u94ae",e),0===this.property.isClickMoveBut?(this.property.isClickMoveBut=e,y.default.ins.log(y.DebugKey.ClickButton,"\u8bb0\u5f55\u79fb\u52a8\u6309\u94ae\uff1a"+e),this.state.moveBut(e)):this.property.isClickMoveBut!==e&&(this.releaseMoveBut(this.property.isClickMoveBut),this.property.isClickMoveBut=e,this.state.moveBut(e))},t.prototype.releaseMoveBut=function(e){y.default.ins.log(y.DebugKey.ClickButton,"\u91ca\u653e\u79fb\u52a8\u6309\u94ae",e),this.property.isClickMoveBut===e&&(this.property.isClickMoveBut=0,y.default.ins.log(y.DebugKey.ClickButton,"\u8bb0\u5f55\u79fb\u52a8\u6309\u94ae\u72b6\u6001\uff1a0"),this.state.releaseMoveBut())},t.prototype.jumpBut=function(){2!==this.property.getJumpCount()&&this.state.jumpBut()},t.prototype.downSpeed=function(){this.state.downSpeed()},t.prototype.upSpeed=function(){this.state.upSpeed()},t.prototype.impulsion=function(e){this.applyImpulsion(e),this.state.impulsion()},t.prototype.beginContact=function(){this.state.beginContact()},t.prototype.endContact=function(){this.state.endContact()},t.prototype.dead=function(e){this.isUpdate&&(y.default.ins.log(y.DebugKey.GameLogic,"palyer are dead:",e),this.state.dead(),m.default.ins.playEffect("sounds/game_over"),this.updateSpeed=!1,this.rigid.linearVelocity=cc.v2(),this.anim.dead(e),this.isUpdate=!1,this.rigid.enabledContactListener=!1,this.collider.enabled=!1,f.default.ins.sendEvent(f.EventType.CloseCtrlPlayer),f.default.ins.sendEvent(f.EventType.StopCameraFollow),f.default.ins.sendEvent(f.EventType.CheckPlayerOutFace))},t.prototype.onBeginContact=function(e,t,o){var n=o.node.group;"FRUIT"!==n&&"INTERACTION"!==n?(this.property.recordCollider(o),this.beginContact()):e.disabled=!0},t.prototype.onEndContact=function(e,t,o){var n=o.node.group;"FRUIT"!==n&&"INTERACTION"!==n&&(this.property.removeRecordOfCollider(o),this.endContact())},t.prototype.climbWallEnable=function(){if(0!==this.property.isClickMoveBut){for(var e,t,o,n,r=!1,a=i.default.getWorldCoordinate(this.node).add(this.collider.offset),s=a.y-this.collider.size.height/2,l=s+this.collider.size.height,c=0,p=this.property.getAllCollider();c<p.length&&"ONEWAYPLATFORM"!==(n=p[c]).node.group&&("FIRE"!==n.node.group||1!==n.tag);c++)if(!(s>=(o=i.default.getWorldCoordinate(n.node).add(n.offset)).y+n.size.height/2||l<=o.y-n.size.height/2))if(1===this.property.isClickMoveBut){if(e=a.x+this.collider.size.width/2,t=o.x-n.size.width/2,Math.abs(e-t)<2){r=!0;break}}else if(-1===this.property.isClickMoveBut){if(e=a.x-this.collider.size.width/2,t=o.x+n.size.width/2,Math.abs(e-t)<2){r=!0;break}}else console.error("\u9519\u8bef\uff01");return r}},t.prototype.applyImpulsion=function(e){this.rigid.applyLinearImpulse(e,this.rigid.getWorldCenter(),!0)},t.prototype.setSpeedY=function(e){this.rigid.linearVelocity=cc.v2(this.rigid.linearVelocity.x,e)},t.prototype.updateLinearVelocity=function(){if(this.updateSpeed){0!==this.property.isClickMoveBut&&(this.anim.node.scaleX=this.property.isClickMoveBut);var e,t=this.property.getExtraSpeed();e=this.selfSpeed+t.x;var o=this.rigid.linearVelocity.y;t.y&&(o=t.y),this.rigid.linearVelocity=cc.v2(e,o)}},t.prototype.checkYSpeed=function(){this.inVerMovedEntity||(this.rigid.linearVelocity.y>1?this.upSpeed():this.rigid.linearVelocity.y<-1&&this.downSpeed())},t.prototype.isLand=function(){for(var e,t=!1,o=0,n=this.property.getAllCollider();o<n.length;o++)if(e=n[o],1===i.default.relativeLocationVertical(this.collider,e,6)){t=!0;break}return t},t.prototype.update=function(e){this.isUpdate&&(this.checkYSpeed(),this.updateLinearVelocity())},t.prototype.onDestroy=function(){f.default.ins.deleteSubscriber(this)},t.climbWallState=new d.ClimbWallState,t.deadState=new r.DeadState,t.doubleJumpState=new a.DoubleJumpState,t.fallState=new s.FallState,t.idleState=new l.IdleState,t.jumpState=new c.JumpState,t.runState=new p.RunState,t.upState=new u.UpState,__decorate([_(n.default)],t.prototype,"anim",void 0),__decorate([_(h.default)],t.prototype,"property",void 0),t=o=__decorate([v],t)}(cc.Component);o.default=S,cc._RF.pop()},{"../common/mathUtil":"mathUtil","../modules/debugUtil":"debugUtil","../modules/eventManager/eventManager":"eventManager","../modules/soundManager":"soundManager","./playerAnim":"playerAnim","./playerState/climbWallState":"climbWallState","./playerState/deadState":"deadState","./playerState/doubleJumpState":"doubleJumpState","./playerState/fallState":"fallState","./playerState/idleState":"idleState","./playerState/jumpState":"jumpState","./playerState/runState":"runState","./playerState/upState":"upState","./property":"property"}],property:[function(e,t,o){"use strict";cc._RF.push(t,"14386pF+1FNE7dLQRVT8y0Q","property"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/mathUtil"),i=e("../modules/debugUtil"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(){function e(){this.speed=120,this.speedInAir=60,this.jumpForce=50,this.climbWallSpeed=20}return e.prototype.init=function(){this.jumpCount=0,this.isClickMoveBut=0,this.extraSpeed=new Map,this.colliderArray=[]},e.prototype.addJumpCount=function(){this.jumpCount++,i.default.ins.log(i.DebugKey.Property,"\u589e\u52a0\u8df3\u8dc3\u6b21\u6570\u5230"+this.jumpCount)},e.prototype.getJumpCount=function(){return i.default.ins.log(i.DebugKey.Property,"\u5f97\u5230\u8df3\u8dc3\u6b21\u6570\u4e3a"+this.jumpCount),this.jumpCount},e.prototype.resetJumpCount=function(){i.default.ins.log(i.DebugKey.Property,"reset jumpCount"),this.jumpCount=0},e.prototype.getExtraSpeed=function(){for(var e,t=this.extraSpeed.values(),o=cc.v2(0,0);e=t.next().value;)o.addSelf(e);return o},e.prototype.recordExtraSpeed=function(e){this.extraSpeed.set(e.who,e.v)},e.prototype.removeExtraSpeed=function(e){this.extraSpeed.has(e)?this.extraSpeed.set(e,cc.v2(0,0)):console.error(e+"\u6ca1\u6709\u7ed9\u89d2\u8272\u901f\u5ea6,\u8bf7\u5904\u7406!")},e.prototype.recordCollider=function(e){this.colliderArray.push(e)},e.prototype.removeRecordOfCollider=function(e){n.default.removeItemFromArray(e,this.colliderArray)},e.prototype.getAllCollider=function(){return this.colliderArray},__decorate([s({tooltip:"\u5730\u9762\u6c34\u5e73\u901f\u5ea6"})],e.prototype,"speed",void 0),__decorate([s({tooltip:"\u7a7a\u4e2d\u6c34\u5e73\u901f\u5ea6"})],e.prototype,"speedInAir",void 0),__decorate([s({tooltip:"\u8df3\u8dc3\u529b"})],e.prototype,"jumpForce",void 0),__decorate([s({tooltip:"\u6293\u5899\u65f6\u7684\u4e0b\u843d\u901f\u5ea6"})],e.prototype,"climbWallSpeed",void 0),e=__decorate([a("PropertyOfPlayer")],e)}();o.default=l,cc._RF.pop()},{"../common/mathUtil":"mathUtil","../modules/debugUtil":"debugUtil"}],resDependence:[function(e,t,o){"use strict";cc._RF.push(t,"c2a03QqGv9JOLVCBodEBr0Z","resDependence"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(){}}(),i=function(){function e(){this.resMap=new Map,this.ccloader=cc.loader}return e.prototype.recordDependence=function(e){this.getResDependInfo(e),this._recordDependence(e)},e.prototype._recordDependence=function(e){var t=this.getDependKeys(e);if(t)for(var o=void 0,n=0,i=t;n<i.length;n++)o=i[n],this.getResDependInfo(o).dependeds.add(e),this.recordDependence(o)},e.prototype.deleteResDependInfo=function(e){this.resMap.delete(e)},e.prototype.getAllResMapKeys=function(){return this.resMap.keys()},e.prototype.removeUse=function(e,t){if(Array.isArray(e))for(var o=0,n=e;o<n.length;o++){var i=n[o];this._removeUse(i,t)}else this._removeUse(e,t)},e.prototype._removeUse=function(e,t){this.getResDependInfo(e).users.delete(t)},e.prototype.recordUse=function(e,t){if(Array.isArray(e))for(var o=0,n=e;o<n.length;o++){var i=n[o];this._recordUse(i,t)}else this._recordUse(e,t)},e.prototype._recordUse=function(e,t){this.getResDependInfo(e).users.add(t)},e.prototype.getDependKeys=function(e){var t=cc.loader._cache[e];if(!t)return console.warn("\u4e0d\u5b58\u5728"+e),null;if("dependKeys"in t){var o=t.dependKeys;if(o&&Array.isArray(o)&&o.length>0)return o}return null},e.prototype.getCacheKey=function(){var e=arguments;if("string"==typeof e[0]){if(e[1]){var t=this.ccloader._getResUuid(e[0],e[1]);return this.ccloader._getReferenceKey(t)}return this.ccloader._getReferenceKey(e[0])}if("object"==typeof e[0])return this.ccloader._getReferenceKey(e[0])},e.prototype.getCacheItem=function(e){return cc.loader._cache[e]},e.prototype.releaseResRecursion=function(e){var t=this.getDependedKeys(e);if(t&&Array.isArray(t)&&t.length>0){var o=void 0;for(o=0;o<t.length;o++)this.releaseResRecursion(t[o])}if(this.releaseEnable(e)){var n=this.getCacheItem(e);if(!n&&this.resMap.has(e))return this.releaseEnable(e)||console.error("\u8be5\u8d44\u6e90\u88ab\u91ca\u653e\u4e86\uff0c\u4f46\u8fd8\u6709\u8d44\u6e90\u4f9d\u8d56\u7740\u5b83"+e),void this.resMap.delete(e);var i=n.dependKeys;if(i&&Array.isArray(i)&&i.length>0){o=void 0;for(o=0;o<i.length;o++)this.removeDepended(e,i[o])}this.releaseOneRes(e)}},e.prototype.getDependedKeys=function(e){var t=this.getResDependInfo(e).dependeds;return this.convertIteratorToArray(t.values())},e.prototype.convertIteratorToArray=function(e){for(var t,o=[];t=e.next().value;)o.push(t);return o},e.prototype.releaseOneRes=function(e){var t=this.getCacheItem(e);t.uuid?cc.loader.release(t.uuid):t.id?cc.loader.release(t.id):console.warn("\u8d44\u6e90\u91ca\u653e\u5931\u8d25",t),this.resMap.delete(e)},e.prototype.releaseEnable=function(e){var t=this.resMap.get(e);return t?0===t.dependeds.size&&0===t.users.size:(console.error("\u6ca1\u6709\u8fd9\u4e2a\u8d44\u6e90\u7684\u8bb0\u5f55"),!1)},e.prototype.removeDepended=function(e,t){this.getResDependInfo(t).dependeds.delete(e)},e.prototype.getResDependInfo=function(e){if(this.resMap.has(e))return this.resMap.get(e);var t=new n;return t.dependeds=new Set,t.users=new Set,this.resMap.set(e,t),t},e}();o.default=i,cc._RF.pop()},{}],resManager:[function(e,t,o){"use strict";cc._RF.push(t,"cb490ZowntAjoo3iXWi9dDS","resManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./resDependence"),i=e("./loadProgress"),r=e("../debugUtil"),a=e("../eventManager/eventManager"),s=e("../../common/mathUtil"),l=function(){function e(e){this.name=e,this.deps=[],this.loadRes=[]}return e.prototype.setLoadRes=function(e){-1===this.loadRes.indexOf(e)&&this.loadRes.push(e)},e.prototype.getLoadRes=function(){return this.loadRes},e.prototype.clearLoadRes=function(){this.loadRes=[]},e}(),c=function(){function e(e){var t=this;this.callback=null;var o=this;this.resDependence=new n.default,this.loadProgress=new i.default,this.loadRes(e,cc.JsonAsset,"resManager",null,function(){o.taskResUrls=t.getRes(e,cc.JsonAsset).json,r.default.ins.log(r.DebugKey.GameLogic,"\u8d44\u6e90\u5217\u8868"+e+"\u52a0\u8f7d\u5b8c\u6210"),a.default.ins.sendEvent(a.EventType.LoadTaskResListComplete)})}return e.init=function(t){this.ins=new e(t)},e.prototype.initFirstScene=function(e,t){var o=this;this.curScene=this.getSceneResDeps();var n=function(){o.recordResDepsAndUseOfScene(o.curScene),t&&t()};e?this.excuteLoadTask(e,this.curScene.name,n):n()},e.prototype.loadScene=function(e,t,o){var n=this;this.lastScene=this.curScene,this.curScene=new l(e);var i=this.loadProgress.registerLoad();cc.director.preloadScene(e,function(e,t,o){n.loadProgress.updateLoadState(i,e,t)},function(t,o){t?console.error("\u9884\u52a0\u8f7d\u573a\u666f"+e+"\u5931\u8d25\u3002"+t):(n.loadProgress.completeId(i),n.loadProgress.isLoadComplete()&&n.loadCompelete())});var r=function(){cc.director.loadScene(e,function(){n.removeResUseOfScene(n.lastScene),n.curScene.deps=n.getSceneResDeps().deps,n.recordResDepsAndUseOfScene(n.curScene),n.releaseIdleRes(),o&&o()})};t?this.excuteLoadTask(t,e,r):this.callback=r},e.prototype.recordResDepsAndUseOfScene=function(e){for(var t,o=e.deps,n=0,i=o;n<i.length;n++)t=i[n],this.resDependence.recordDependence(t);this.resDependence.recordUse(o,e.name)},e.prototype.removeResUseOfScene=function(e){var t=e.getLoadRes().concat(e.deps);this.resDependence.removeUse(t,e.name)},e.prototype.getSceneResDeps=function(){var e=new l,t=cc.director.getScene();return e.name=t.name,e.deps=t.dependAssets,e},e.prototype.excuteLoadTask=function(e,t,o){if(this.taskResUrls){o&&(this.callback=o);for(var n,i=0,r=this.taskResUrls[e];i<r.length;i++)n=r[i],this.loadResArray(n.urls,this.stringToType(n.type),t)}else console.error("\u4efb\u52a1\u8d44\u6e90\u5bf9\u8c61\u4e3a\u7a7a")},e.prototype.loadNextLevel=function(e,t){var o=this,n=this.curScene.getLoadRes();this.curScene.clearLoadRes(),this.resDependence.removeUse(n,this.curScene.name),this.excuteLoadTask(e,this.curScene.name,function(){o.releaseIdleRes(),t&&t()})},e.prototype.loadResArray=function(e,t,o){for(var n,i=this,r=function(){var e=a.loadProgress.registerLoad();a.loadRes(n,t,o,function(t,o){i.loadProgress.updateLoadState(e,t,o)},function(t){i.loadProgress.completeId(e),i.curScene&&i.curScene.setLoadRes(t),i.loadProgress.isLoadComplete()&&i.loadCompelete()})},a=this,s=0,l=e;s<l.length;s++)n=l[s],r()},e.prototype.stringToType=function(e){switch(e){case"prefab":return cc.Prefab;case"spriteAtlas":return cc.SpriteAtlas;case"spriteFrame":return cc.SpriteFrame;case"json":return cc.JsonAsset;case"audio":return cc.AudioClip}},e.prototype.loadCompelete=function(){var e;this.callback&&(e=this.callback,this.callback=null),this.loadProgress.clearRecord(),e&&e()},e.prototype.loadRes=function(e,t,o,n,i){var r=this,a=this,s=function(n){var s=r.resDependence.getCacheKey(e,t);a.resDependence.recordUse(s,o),a.resDependence.recordDependence(s),i&&i(s)};if(cc.loader.getRes(e,t))return console.warn("\u8d44\u6e90"+e+"\u5df2\u52a0\u8f7d"),void s();cc.loader.loadRes(e,t,function(e,t,o){n&&n(e,t)},function(e,t){e?console.error(e):s()})},e.prototype.getRes=function(e,t){var o=cc.loader.getRes(e,t);return o||console.error(e+"\u8d44\u6e90\u4e0d\u5b58\u5728"),o},e.prototype.releaseIdleRes=function(){for(var e,t=this.resDependence.getAllResMapKeys();e=t.next().value;)this.resDependence.releaseResRecursion(e)},e.prototype.outputCurResNum=function(){var e=cc.loader;console.log("\u5f53\u524d\u8d44\u6e90\u6570:",s.default.lenOfObject(e._cache)),console.log(cc.director.getScene())},e.ins=null,e}();o.default=c,cc._RF.pop()},{"../../common/mathUtil":"mathUtil","../debugUtil":"debugUtil","../eventManager/eventManager":"eventManager","./loadProgress":"loadProgress","./resDependence":"resDependence"}],reviewStar:[function(e,t,o){"use strict";cc._RF.push(t,"6a9391mLIlMdLSciwvvIy0D","reviewStar"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stars=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.stars=this.node.children},t.prototype.review=function(e){var t;for(t=0;t<e;t++)this.stars[t].opacity=255;for(;t<3;t++)this.stars[t].opacity=50},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],rockHeadBg:[function(e,t,o){"use strict";cc._RF.push(t,"f5bf7z8b/ZGbb57UcmqcTPJ","rockHeadBg"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/commonVar"),i=e("../../modules/debugUtil"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blinkAtlas=null,t.leftHitAtlas=null,t.rightHitAtlas=null,t.bottomHitAtlas=null,t.topHitAtlas=null,t.idleImg=null,t.anim=null,t.frameAnim=null,t.clip=null,t.curDir=null,t.postDir=null,t.nextDir=null,t.animState=null,t.first=!0,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.node.getComponent(cc.Animation),this.frameAnim=this.node.getComponent("frameAnim"),this.frameAnim.setIdleImg(this.idleImg)},t.prototype.start=function(){},t.prototype.init=function(e){this.anim.addClip(this.clip),this.animState=this.anim.getAnimationState(this.clip.name),this.animState.speed=e},t.prototype.setupAnim=function(e){i.default.ins.log(i.DebugKey.RockHead,"\u542f\u52a8\u79fb\u52a8\u5934"),this.curDir=e,this.animState.play(),this.blink()},t.prototype.arrivePoint=function(e){this.first?this.first=!1:(this.postDir=this.curDir,this.curDir=null,this.nextDir=this._stringTpDIR(e),this.animState.pause(),this.playHit(this.postDir),this.node.dispatchEvent(new cc.Event.EventCustom("arriveP",!0)))},t.prototype.arrivePointBefore=function(e){e?this._stringTpDIR(e)===this.curDir&&this.node.dispatchEvent(new cc.Event.EventCustom("pressCheck",!0)):console.error("\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a")},t.prototype.continuePlay=function(){this.curDir=this.nextDir,this.animState.resume(),this.blink()},t.prototype.playHit=function(e){switch(e){case n.DIR.left:this.leftHit();break;case n.DIR.right:this.rightHit();break;case n.DIR.up:this.topHit();break;case n.DIR.down:this.bottomHit()}},t.prototype._stringTpDIR=function(e){switch(e){case"left":return n.DIR.left;case"right":return n.DIR.right;case"up":return n.DIR.up;case"down":return n.DIR.down}},t.prototype.leftHit=function(){this.frameAnim.stop(),this.frameAnim.setSpriteAtlas(this.leftHitAtlas),this.frameAnim.play()},t.prototype.rightHit=function(){this.frameAnim.stop(),this.frameAnim.setSpriteAtlas(this.rightHitAtlas),this.frameAnim.play()},t.prototype.bottomHit=function(){this.frameAnim.stop(),this.frameAnim.setSpriteAtlas(this.bottomHitAtlas),this.frameAnim.play()},t.prototype.topHit=function(){this.frameAnim.stop(),this.frameAnim.setSpriteAtlas(this.topHitAtlas),this.frameAnim.play()},t.prototype.blink=function(){this.frameAnim.stop(),this.frameAnim.setSpriteAtlas(this.blinkAtlas),this.frameAnim.play(!0)},t.prototype.onDestroy=function(){this.animState&&this.animState.stop()},__decorate([s(cc.SpriteAtlas)],t.prototype,"blinkAtlas",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"leftHitAtlas",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"rightHitAtlas",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"bottomHitAtlas",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"topHitAtlas",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"idleImg",void 0),__decorate([s(cc.AnimationClip)],t.prototype,"clip",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../common/commonVar":"commonVar","../../modules/debugUtil":"debugUtil"}],rockHead:[function(e,t,o){"use strict";cc._RF.push(t,"fa98e+10ndKQIFR7q8Tn4zr","rockHead"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./rockHeadBg"),i=e("../../modules/debugUtil"),r=e("../../common/commonVar"),a=e("../../common/mathUtil"),s=e("../../modules/eventManager/eventManager"),l=cc._decorator,c=l.ccclass,p=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=1,t.dockingT=3,t.anim=null,t.firstMoveDir=r.Dir.right,t.haveSpike=!1,t.haveAnim=!0,t.bugUtil=i.default.ins,t.ct=0,t.isDocking=!1,t.playerUnder=!1,t.rigid=null,t.collider=null,t.player=null,t.postP=null,t.notifiedPVerMove=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.rigid=this.node.getComponent(cc.RigidBody),this.collider=this.node.getComponent(cc.PhysicsBoxCollider),this.node.on("arriveP",this.arriveP,this),this.node.on("pressCheck",this.pressCheck,this),s.default.ins.onEventOnce(s.EventType.InitGameScene,this.init,this)},t.prototype.init=function(){this.haveAnim&&(this.postP=this.node.getPosition(),this.anim.init(this.speed),this.anim.setupAnim(this.firstMoveDir))},t.prototype.arriveP=function(){this.isDocking=!0,this.ct=0},t.prototype.pressCheck=function(){if(null!==this.player)switch(this.anim.curDir){case r.DIR.down:a.default.isSide(this.player,this.collider,r.DIR.down)&&s.default.ins.sendEvent(s.EventType.Dead);break;case r.DIR.up:a.default.isSide(this.player,this.collider,r.DIR.up)&&s.default.ins.sendEvent(s.EventType.Dead);break;case r.DIR.left:a.default.isSide(this.player,this.collider,r.DIR.left)&&s.default.ins.sendEvent(s.EventType.Dead,this.getRandomHitData(this.anim.curDir));break;case r.DIR.right:a.default.isSide(this.player,this.collider,r.DIR.right)&&s.default.ins.sendEvent(s.EventType.Dead,this.getRandomHitData(this.anim.curDir))}},t.prototype.getRandomHitData=function(e){var t=new r.HitData;return e===r.DIR.left?(t.force=cc.v2(-a.default.getRandomInteger(20,40),0),t.rotate=a.default.getRandomInteger(30,90)):r.DIR.right?(t.force=cc.v2(a.default.getRandomInteger(20,40),0),t.rotate=-a.default.getRandomInteger(30,90)):t=null,t},t.prototype.getHitDataWithSpike=function(e,t){var o=new r.HitData,n=a.default.getRelativeDir(e,t);return n===r.DIR.up?(o.force=cc.v2(0,a.default.getRandomInteger(20,40)),o.rotate=a.default.getRandomInteger(30,90)):n===r.DIR.down?(o.force=cc.v2(0,-a.default.getRandomInteger(5,20)),o.rotate=a.default.getRandomInteger(-10,-20)):n===r.DIR.left?(o.force=cc.v2(-a.default.getRandomInteger(20,40),0),o.rotate=a.default.getRandomInteger(30,90)):n===r.DIR.right&&(o.force=cc.v2(a.default.getRandomInteger(20,40),0),o.rotate=-a.default.getRandomInteger(30,90)),o},t.prototype.onBeginContact=function(e,t,o){"PLAYER"===o.node.group&&(this.haveSpike?(e.disabled=!0,s.default.ins.sendEvent(s.EventType.Dead,this.getHitDataWithSpike(t,o))):(this.bugUtil.log(i.DebugKey.RockHead,"\u78b0\u649e\u89d2\u8272"),this.player=o,1===a.default.relativeLocationVertical(o,t)&&(this.bugUtil.log(i.DebugKey.RockHead,"\u89d2\u8272\u5728\u5176\u4e0a\u9762"),this.playerUnder=!0,this.isVerMoving()&&(this.bugUtil.log(i.DebugKey.RockHead,"\u5904\u4e8e\u5782\u76f4\u79fb\u52a8\u72b6\u6001\uff0c\u544a\u8bc9\u89d2\u8272\u5728\u5782\u76f4\u79fb\u52a8\u5b9e\u4f53\u4e0a"),s.default.ins.sendEvent(s.EventType.InVerMovedEntity),this.notifiedPVerMove=!0))))},t.prototype.onEndContact=function(e,t,o){this.bugUtil.log(i.DebugKey.RockHead,"\u7ed3\u675f\u78b0\u649e"),this.player=null,this.playerUnder&&(this.bugUtil.log(i.DebugKey.RockHead,"\u89d2\u8272\u4ece\u79fb\u52a8\u5934\u4e0a\u79bb\u5f00"),this.playerUnder=!1,this.notifiedPVerMove&&(s.default.ins.sendEvent(s.EventType.ExitVerMovedEntiry),this.notifiedPVerMove=!1))},t.prototype.isHoriMoving=function(){return this.anim.curDir===r.DIR.left||this.anim.curDir===r.DIR.right},t.prototype.isVerMoving=function(){return this.anim.curDir===r.DIR.up||this.anim.curDir===r.DIR.down},t.prototype.update=function(e){if(null===this.anim.curDir)this.ct+=e,this.ct>=this.dockingT&&(this.bugUtil.log(i.DebugKey.RockHead,"\u505c\u9760\u7ed3\u675f\uff0c\u7ee7\u7eed\u79fb\u52a8"),this.anim.continuePlay());else{var t=this.node.getPosition();if(this.playerUnder&&this.isHoriMoving()){var o=this.player.node.getPosition();this.player.node.setPosition(o.add(t.sub(this.postP)))}this.postP=t}},__decorate([p()],t.prototype,"speed",void 0),__decorate([p({displayName:"\u505c\u9760\u65f6\u95f4"})],t.prototype,"dockingT",void 0),__decorate([p(n.default)],t.prototype,"anim",void 0),__decorate([p({type:r.Dir,tooltip:"\u9996\u6b21\u79fb\u52a8\u65b9\u5411"})],t.prototype,"firstMoveDir",void 0),__decorate([p({displayName:"\u6709\u9f7f"})],t.prototype,"haveSpike",void 0),__decorate([p()],t.prototype,"haveAnim",void 0),t=__decorate([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../common/commonVar":"commonVar","../../common/mathUtil":"mathUtil","../../modules/debugUtil":"debugUtil","../../modules/eventManager/eventManager":"eventManager","./rockHeadBg":"rockHeadBg"}],runState:[function(e,t,o){"use strict";cc._RF.push(t,"9b30e1bEO1HyZM+XdPzVlon","runState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){},t.prototype.releaseMoveBut=function(){this.player.setState(i.default.idleState)},t.prototype.jumpBut=function(){this.player.setState(i.default.jumpState)},t.prototype.downSpeed=function(){this.player.setState(i.default.fallState)},t.prototype.upSpeed=function(){this.player.setState(i.default.upState)},t.prototype.beginContact=function(){},t.prototype.endContact=function(){},t.prototype.impulsion=function(){},t.prototype.enter=function(){r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u5230\u5954\u8dd1\u72b6\u6001"),this.player.anim.run(),this.player.setSelfSpeed(this.property.speed*this.property.isClickMoveBut),this.property.resetJumpCount()},t.prototype.exit=function(){this.player.anim.stop(),this.player.setSelfSpeed(0)},t=__decorate([s],t)}(n.default));o.RunState=l,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../player":"player","./playerState":"playerState"}],sawBg:[function(e,t,o){"use strict";cc._RF.push(t,"26adfKTmfJInYZ3Myf7pHf+","sawBg"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=n.disallowMultiple,s=n.requireComponent,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAtlas=null,t.clip=null,t.frameAnim=null,t.anim=null,t.animState=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.frameAnim=this.node.getComponent("frameAnim"),this.anim=this.node.getComponent(cc.Animation)},t.prototype.setup=function(e,t){this.frameAnim.setSpriteAtlas(this.onAtlas),t||(this.anim.addClip(this.clip),this.animState=this.anim.getAnimationState(this.clip.name),this.animState.speed=e,this.animState.play()),this.frameAnim.play(!0)},t.prototype.arriveP=function(){this.node.dispatchEvent(new cc.Event.EventCustom("arriveP",!0))},t.prototype.continueMove=function(){this.animState.resume(),this.frameAnim.play(!0)},t.prototype.pauseMove=function(){this.animState.pause(),this.frameAnim.stop()},t.prototype.onBeginContact=function(e,t,o){if("PLAYER"===o.node.group){var n=new cc.Event.EventCustom("onBeginContact",!0);n.detail=e,this.node.dispatchEvent(n)}},t.prototype.onDestroy=function(){this.animState&&this.animState.stop()},__decorate([r(cc.SpriteAtlas)],t.prototype,"onAtlas",void 0),__decorate([r(cc.AnimationClip)],t.prototype,"clip",void 0),t=__decorate([i,a,s(cc.Animation)],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],saw:[function(e,t,o){"use strict";cc._RF.push(t,"7c27174n+VIhJxnKHwUgj6j","saw"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../common/commonVar"),i=e("../../common/mathUtil"),r=e("../../modules/eventManager/eventManager"),a=cc._decorator,s=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dockT=2,t.force=50,t.speed=1,t.fixed=!1,t.anim=null,t.ct=0,t.isDocking=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.node.getComponent("sawBg");var e=this;r.default.ins.onEvent(r.EventType.InitGameScene,function(){e.anim.setup(e.speed,e.fixed)},this),this.node.on("arriveP",function(){e.anim.pauseMove(),e.ct=0,e.isDocking=!0},this),this.node.on("onBeginContact",this._onBeginContact,this)},t.prototype._onBeginContact=function(e){e.stopPropagation();var t=e.detail.getWorldManifold().normal,o=new n.HitData;t.x>0?o.rotate=-i.default.getRandomInteger(25,90):t.x>0?o.rotate=i.default.getRandomInteger(25,90):o.rotate=null,o.force=cc.v2(this.force*t.x,this.force*t.y),r.default.ins.sendEvent(r.EventType.Dead,o)},t.prototype.update=function(e){this.isDocking&&(this.ct+=e,this.ct>=this.dockT&&(this.isDocking=!1,this.anim.continueMove()))},t.prototype.onDestroy=function(){r.default.ins.deleteSubscriber(this)},__decorate([l({displayName:"\u505c\u9760\u65f6\u95f4"})],t.prototype,"dockT",void 0),__decorate([l()],t.prototype,"force",void 0),__decorate([l()],t.prototype,"speed",void 0),__decorate([l({tooltip:"\u6ca1\u6709\u52a8\u753b\uff0c\u56fa\u5b9a\u7684"})],t.prototype,"fixed",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../common/commonVar":"commonVar","../../common/mathUtil":"mathUtil","../../modules/eventManager/eventManager":"eventManager"}],scoreMgr:[function(e,t,o){"use strict";cc._RF.push(t,"39b12sRqjhIzIULLbXZgFE5","scoreMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=e("../modules/dataManager"),r=e("../modules/global"),a=cc._decorator,s=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLab=null,t.countDownLab=null,t.warningTime=20,t.isUpdate=!0,t.outTime=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.eventMgr=n.default.ins,this.onEvent()},t.prototype.onEvent=function(){var e=this;this.eventMgr.onEvent(n.EventType.InitScoreMgr,this.init,this),this.eventMgr.onEvent(n.EventType.AddScore,this.addCollectNum,this),this.eventMgr.onEvent(n.EventType.Dead,function(){e.isUpdate=!1},this),this.eventMgr.onEvent(n.EventType.Win,function(){e.isUpdate=!1},this),this.eventMgr.onEvent(n.EventType.MakeScore,function(){e.eventMgr.sendEvent(n.EventType.ShowWinPanel,e.makeScore())},this)},t.prototype.init=function(){this.needCollectFruitSum=i.default.ins.getFruitSumOfLvel(r.default.ins.curLevelNum),this.ct=i.default.ins.getTimeOfLevel(r.default.ins.curLevelNum),this._ct=this.ct,this.collectedFruitSum=0,this.isUpdate=!0,this.outTime=!1,this.refreshShowedCollectedFruit(),this.refreshTime(this.ct)},t.prototype.addCollectNum=function(){this.collectedFruitSum+=1,this.refreshShowedCollectedFruit()},t.prototype.refreshShowedCollectedFruit=function(){this.scoreLab.string="\u6c34\u679c:"+this.collectedFruitSum+"/"+this.needCollectFruitSum},t.prototype.refreshTime=function(e){this.ct<0&&(this.ct=0),this.countDownLab.string=this.convertSecondToTime(this.ct),e<=this.warningTime&&(this.countDownLab.node.color!==cc.Color.RED&&(this.countDownLab.node.color=cc.Color.RED),this.countDownLab.node.runAction(cc.blink(.5,1)))},t.prototype.makeScore=function(){console.log("\u6e38\u620f\u7528\u65f6\uff1a"+(i.default.ins.getTimeOfLevel(r.default.ins.curLevelNum)-this.ct)+"\uff0c\u6536\u96c6\u6c34\u679c\u6570:"+this.collectedFruitSum);var e=[1];return this.outTime||(e[1]=1),this.collectedFruitSum===this.needCollectFruitSum?e[2]=1:this.collectedFruitSum>this.needCollectFruitSum&&(e[2]=1,console.warn("\u6c34\u679c\u603b\u6570\u91cf\u6709\u8bef\uff0c\u8bf7\u4fee\u6539")),e},t.prototype.update=function(e){if(this.isUpdate&&!this.outTime)if(this.ct<=0)this.outTime=!0;else{this._ct-=e;var t=this._ct-this._ct%1;t<this.ct&&(this.ct=t,this.refreshTime(this.ct))}},t.prototype.convertSecondToTime=function(e){var t,o;return o=e-60*(t=Math.floor(e/60)),(t<10?"0"+t:t.toString())+":"+(o<10?"0"+o:o.toString())},t.prototype.onDestroy=function(){this.eventMgr.deleteSubscriber(this)},__decorate([l(cc.Label)],t.prototype,"scoreLab",void 0),__decorate([l(cc.Label)],t.prototype,"countDownLab",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../modules/dataManager":"dataManager","../modules/eventManager/eventManager":"eventManager","../modules/global":"global"}],selectPanel:[function(e,t,o){"use strict";cc._RF.push(t,"df4af2ryPRA26dJFK+c+rZd","selectPanel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../modules/dataManager"),i=e("../../modules/eventManager/eventManager"),r=e("./horizelScrollView"),a=e("../../modules/resManager/resManager"),s=e("../../modules/debugUtil"),l=e("../../modules/global"),c=cc._decorator,p=c.ccclass,u=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.starNum=null,t.horizelScrollPage=null,t.emptyPage=null,t.num=15,t.initC=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.dataMgr=n.default.ins,this.eventMgr=i.default.ins,this.resMgr=a.default.ins,this.eventMgr.onEventOnce(i.EventType.InitConfigComplete,this.init,this),this.eventMgr.onEventOnce(i.EventType.InitUserDataComplete,this.init,this),this.eventMgr.onEvent(i.EventType.OpenSelectLevelPanel,this.open,this),this.eventMgr.onEvent(i.EventType.CloseSelectLevelPanel,this.close,this),this.node.on("updatePageContent",this.updatePageContent,this)},t.prototype.start=function(){l.default.ins.isFirstInitSelectPanel||this.init()},t.prototype.init=function(){if(l.default.ins.isFirstInitSelectPanel){if(this.initC++,console.log("\u9009\u5173\u9762\u677f...",this.initC),this.initC<2)return;l.default.ins.isFirstInitSelectPanel=!1}this.emptyPage=this.resMgr.getRes("prefabs/ui/selectPanel/page",cc.Prefab),this.starSum=3*this.dataMgr.levelSum,this.levelSum=this.starSum/3,this.pageSum=Math.ceil(this.levelSum/this.num),this.createPage(),this.freshShowedStar(),this.node.setPosition(0,0),this.node.active=!1,s.default.ins.log(s.DebugKey.GameLogic,"\u9009\u5173\u9762\u677f\u521d\u59cb\u5316\u5b8c\u6210")},t.prototype.createPage=function(){this.horizelScrollPage.init(this.emptyPage,this.pageSum);for(var e=this.horizelScrollPage.getPages(),t=0;t<e.length;t++)this.setPage(e[t],t)},t.prototype.freshShowedStar=function(){this.starNum.string="("+this.dataMgr.getedStarSum()+"/"+this.starSum+")"},t.prototype.setPage=function(e,t){var o;o=e.getComponent("page");var n=this.getLevelOfPage(t);o.init(n[0],n[1])},t.prototype.getLevelOfPage=function(e){var t=1+this.num*e;return[t,e===this.pageSum-1?this.levelSum:t+this.num-1]},t.prototype.open=function(){this.eventMgr.sendEvent(i.EventType.OpenPanel,this.node)},t.prototype.close=function(){this.eventMgr.sendEvent(i.EventType.ClosePanel,this.node)},t.prototype.updatePageContent=function(e){var t=e.detail[0],o=e.detail[1];this.setPage(t,o)},t.prototype.onDestroy=function(){this.eventMgr.deleteSubscriber(this)},__decorate([u(cc.Label)],t.prototype,"starNum",void 0),__decorate([u(r.default)],t.prototype,"horizelScrollPage",void 0),t=__decorate([p],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../modules/dataManager":"dataManager","../../modules/debugUtil":"debugUtil","../../modules/eventManager/eventManager":"eventManager","../../modules/global":"global","../../modules/resManager/resManager":"resManager","./horizelScrollView":"horizelScrollView"}],soundManager:[function(e,t,o){"use strict";cc._RF.push(t,"acb78QPi2pCvaTTdRbiWhvR","soundManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./resManager/resManager"),i=function(){function e(){this.isOpenSounds=!0}return e.init=function(){this.ins=new e},e.prototype.openSound=function(){this.playBGM("sounds/BGM")},e.prototype.closeSound=function(){this.isOpenSounds&&this.pauseBGM(),this.isOpenSounds=!1},e.prototype.playBGM=function(e,t){this.isOpenSounds=!0,t&&cc.audioEngine.setMusicVolume(t),cc.audioEngine.playMusic(n.default.ins.getRes(e,cc.AudioClip),!0)},e.prototype.pauseBGM=function(){this.isOpenSounds=!1,cc.audioEngine.pauseMusic()},e.prototype.playEffect=function(e,t){this.isOpenSounds&&(t&&cc.audioEngine.setEffectsVolume(t),cc.audioEngine.playEffect(n.default.ins.getRes(e,cc.AudioClip),!1))},e.ins=null,e}();o.default=i,cc._RF.pop()},{"./resManager/resManager":"resManager"}],spikedBall:[function(e,t,o){"use strict";cc._RF.push(t,"f3cd1RPxRBN/LY+sQu10I9n","spikedBall"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=e("../common/commonVar"),r=cc._decorator,a=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=1,t.clip=null,t.wrapMode=cc.WrapMode.Default,t.anim=null,t.animState=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.node.getComponent(cc.Animation),this.init()},t.prototype.init=function(){this._initAnim(),this.animState.play(),this.wrapMode!==cc.WrapMode.Default&&(this.animState.wrapMode=this.wrapMode)},t.prototype._initAnim=function(){this.anim.addClip(this.clip),this.animState=this.anim.getAnimationState(this.clip.name),this.animState.speed=this.speed},t.prototype.onBeginContact=function(e,t,o){"PLAYER"===o.node.group&&(n.default.ins.sendEvent(n.EventType.CanRotate),n.default.ins.sendEvent(n.EventType.Dead))},t.prototype.onDestroy=function(){this.animState&&this.animState.stop()},__decorate([s()],t.prototype,"speed",void 0),__decorate([s(cc.AnimationClip)],t.prototype,"clip",void 0),__decorate([s({type:cc.Enum(i.WrapMode),tooltip:"\u52a8\u753b\u64ad\u653e\u7c7b\u578b"})],t.prototype,"wrapMode",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../common/commonVar":"commonVar","../modules/eventManager/eventManager":"eventManager"}],spike:[function(e,t,o){"use strict";cc._RF.push(t,"81028q7vOBFO4djZFTMMtbI","spike"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/commonVar"),i=e("../common/mathUtil"),r=e("../modules/eventManager/eventManager"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.implusion=50,t.implusionOffset=10,t.minR=30,t.maxR=90,t}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){if("PLAYER"===o.node.group){var a=t.getAABB(),s=o.getAABB(),l=new n.HitData;Math.abs(a.x+a.width-s.x)<10?(l.force=cc.v2(-this.implusionOffset,this.implusion),l.rotate=-i.default.getRandomInteger(this.minR,this.maxR)):Math.abs(a.x-s.x-s.width)<10?(l.force=cc.v2(this.implusionOffset,this.implusion),l.rotate=i.default.getRandomInteger(this.minR,this.maxR)):(l.force=cc.v2(0,this.implusion),l.rotate=i.default.getRandomInteger(-45,45)),r.default.ins.sendEvent(r.EventType.Dead,l)}},t=__decorate([s],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../common/commonVar":"commonVar","../common/mathUtil":"mathUtil","../modules/eventManager/eventManager":"eventManager"}],switchBut:[function(e,t,o){"use strict";cc._RF.push(t,"a45656qKphC+qxFiWtkyVjE","switchBut"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,r=n.property,a=n.disallowMultiple,s=n.menu,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state1=null,t.state2=null,t.clickEvent1=new cc.Component.EventHandler,t.clickEvent2=new cc.Component.EventHandler,t.sprite=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.sprite=this.node.getComponent(cc.Sprite),this.node.on(cc.Node.EventType.TOUCH_START,this.click,this)},t.prototype.click=function(){this.sprite.spriteFrame===this.state1?(this.sprite.spriteFrame=this.state2,this.clickEvent2.emit(null)):(this.sprite.spriteFrame=this.state1,this.clickEvent1.emit(null))},t.prototype.setState=function(e){this.sprite.spriteFrame=1===e?this.state1:this.state2},__decorate([r(cc.SpriteFrame)],t.prototype,"state1",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"state2",void 0),__decorate([r(cc.Component.EventHandler)],t.prototype,"clickEvent1",void 0),__decorate([r(cc.Component.EventHandler)],t.prototype,"clickEvent2",void 0),t=__decorate([i,a(),s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/SwitchBut")],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],upState:[function(e,t,o){"use strict";cc._RF.push(t,"98173vBjH5IHq56NcN5IC0Z","upState"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./playerState"),i=e("../player"),r=e("../../modules/debugUtil"),a=cc._decorator,s=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.moveBut=function(e){this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.releaseMoveBut=function(){this.player.setSelfSpeed(0)},t.prototype.jumpBut=function(){1===this.property.getJumpCount()&&this.player.setState(i.default.doubleJumpState)},t.prototype.downSpeed=function(){this.player.setState(i.default.fallState)},t.prototype.upSpeed=function(){},t.prototype.beginContact=function(){this.player.isLand()&&(0===this.property.isClickMoveBut?this.player.setState(i.default.idleState):this.player.setState(i.default.runState))},t.prototype.endContact=function(){},t.prototype.impulsion=function(){},t.prototype.enter=function(){r.default.ins.log(r.DebugKey.PlayerState,"\u8fdb\u5165\u5230\u4e0a\u5347\u72b6\u6001"),this.player.anim.up();var e=this.property.isClickMoveBut;0!==e&&this.player.setSelfSpeed(this.property.speedInAir*e)},t.prototype.exit=function(){},t=__decorate([s],t)}(n.default));o.UpState=l,cc._RF.pop()},{"../../modules/debugUtil":"debugUtil","../player":"player","./playerState":"playerState"}],upspring:[function(e,t,o){"use strict";cc._RF.push(t,"dab43WBBgpDQbZbucIZbQlx","upspring"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../modules/eventManager/eventManager"),i=cc._decorator,r=i.ccclass,a=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.on=null,t.idle=null,t.force=80,t.anim=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.node.addComponent("frameAnim")},t.prototype.start=function(){this.init()},t.prototype.init=function(){this.anim.setIdleImg(this.idle),this.anim.setSpriteAtlas(this.on)},t.prototype.onBeginContact=function(e,t,o){if("PLAYER"===o.node.group){if(this.anim.isPlaying())return;this.anim.play(),n.default.ins.sendEvent(n.EventType.ChangeSpeedYPlayer,0),n.default.ins.sendEvent(n.EventType.ApplyImpulsionToPlayer,cc.v2(0,this.force))}},__decorate([a(cc.SpriteAtlas)],t.prototype,"on",void 0),__decorate([a(cc.SpriteFrame)],t.prototype,"idle",void 0),__decorate([a({displayName:"\u529b"})],t.prototype,"force",void 0),t=__decorate([r],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../modules/eventManager/eventManager":"eventManager"}]},{},["adaptScreen","adaptWXMenu","butControl","cameraFollow","commonVar","frameAnim","loadPage","mathUtil","myComponent","reviewStar","switchBut","debug","UIEvent","background","butController","gameScene","keyControl","scoreMgr","game","indexScene","openPhysicsEngine","horizelScrollView","level","page","selectPanel","arrow","block","blockBg","blowWind","box","boxBg","chip","endPoint","fallingPf","fire","fruit","fruitManager","movedPlatform","movedPlatformBg","oneWayPlatform","rockHead","rockHeadBg","saw","sawBg","spike","spikedBall","upspring","UIHelper","dataManager","dataStorage","debugUtil","eventCenter","eventManager","global","IDataStorage","loadProgress","resDependence","resManager","soundManager","player","playerAnim","climbWallState","deadState","doubleJumpState","fallState","idleState","jumpState","playerState","runState","upState","property"]);